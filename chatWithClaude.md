[](https://claude.ai/new)

* [Start new chat](https://claude.ai/new)
* [Projects](https://claude.ai/projects)
* [Chats](https://claude.ai/recents)

### Starred

* [Generating Effective Marketing System Prompts](https://claude.ai/chat/9c6fead4-c2c5-4ca4-8bbe-0cce0caf4f27)

### Recents

* [Installing Code Editor Themes Like Claude UI](https://claude.ai/chat/431aae93-535b-4b1d-ba74-a4b76bf189ac)
* [Leveraging MongoDB Atlas Triggers for YouTube Analytics](https://claude.ai/chat/ffd6446b-41e8-427d-962d-49ad14265aee)
* [Getting Started with MongoDB Atlas: A Comprehensive Guide](https://claude.ai/chat/88c0f6dd-171c-46b8-8c89-0592cdb99809)
* [Effective Marketing Copywriting Techniques](https://claude.ai/chat/42ec2d86-4082-41d6-b7bc-de5a8df6b784)
* [Leveraging AI for Business Professionals](https://claude.ai/chat/dfdb1258-fd77-4ead-b8f4-8370dc95d017)
* [Crafting Captivating Tech Influencer Content](https://claude.ai/chat/b53e6e14-a5bb-4145-8b45-acd6005fa07f)
* [Optimizing Database Structure and Data Management for View Trap](https://claude.ai/chat/d5f46c15-348a-4916-83d7-deccf74f0753)
* [Streamlining Retail Management with Smart CCTV](https://claude.ai/chat/8b6226e6-ce3c-4e50-b13e-eb738f3d5175)
* [Become a Lucrative CCTV Technician in 4 Weeks](https://claude.ai/chat/9c97284a-2a3c-4688-9f13-35a6f97a0186)
* [Improving Readability of Landing Page](https://claude.ai/chat/7af67f30-baf5-4fff-b32d-ec066d651189)
* [Reverse-Engineering Effective Landing Page Design](https://claude.ai/chat/43de9e52-08e9-4aab-b59f-70b3c730cc13)
* [Onboarding Process and Payment Terms for Payple](https://claude.ai/chat/929c8cd4-1452-4af0-8cde-fdcc800aeb02)
* [(New chat)](https://claude.ai/chat/e8ba5134-0cf9-487f-930a-dee612707b38)
* [The True Meaning of Execution](https://claude.ai/chat/3d6187ab-addf-4b9d-8e93-9411d2c88633)
* [Avoiding Questionable &#34;Get Rich Quick&#34; Schemes](https://claude.ai/chat/7f8d028b-8d7e-4f89-9dba-14c02540625e)
* [Business Registration Details](https://claude.ai/chat/bb1e1927-13eb-4f47-8e27-2f77558b976d)
* [ğŸ’¬ ìŠ¤í¬ë¦° ë¦¬ë” ì§€ì›ì´ ì‚¬ìš© ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.     ë“œë¼ì´...](https://claude.ai/chat/4d5237fb-0db9-4af3-9592-9a026fcffcdb)
* [Reverse-Engineering a Blog Post for CCTV Security](https://claude.ai/chat/ae64e4d2-85e0-4771-bda3-ca161a1b3432)
* [Customizing Zen Browser with Themes and Plugins](https://claude.ai/chat/74e8f443-10a4-41f1-bdfb-7d9ffed41bca)
* [Verifying Correct Implementation of Knowledge Database Functions](https://claude.ai/chat/328c3139-06dd-4039-829c-c9a6e4d3d63f)
* [Automating Instagram Likes and Interactions](https://claude.ai/chat/ad0c3678-7871-4e8c-af99-0c7a3faad22d)
* [Monetizing Tech Skills: Pulling Content and Conversion Strategies](https://claude.ai/chat/7883be0f-bd79-41ac-805f-3d32cfd1f1a3)
* [Insider Tips for Tech Entrepreneurs to Become &#34;Tech Billionaires&#34;](https://claude.ai/chat/221250bf-0f2a-4b2d-b69e-b8737bf7de32)
* [Proven Strategies for Tech Professionals to Become Wealthy](https://claude.ai/chat/826f708e-531e-4f99-8bba-5e1440f35525)
* [Troubleshooting API Key Access in Next.js](https://claude.ai/chat/c3fb07c2-10f5-47b0-a589-a538216aebd6)
* [Automate Your Workflow with AI: Boost Productivity and Simplify Tasks](https://claude.ai/chat/dc6e8b34-55a0-4b16-a7e8-dca8b9476627)
* [Upgrading Landing Page Copy and Design](https://claude.ai/chat/1f2129e7-0879-4aa4-9c54-189e8296998e)
* [TECì¹´í˜_ì„¸ë¯¸ë‚˜í›„ê¸°_í…œí”Œë¦¿](https://claude.ai/chat/0be3c654-3dce-4f97-84b6-14e23ace21c4)
* [Crafting Impactful Copy for Tech Education Center Landing Page](https://claude.ai/chat/3e6484b8-db6c-4750-b93d-29ceb0251a14)
* [Visualizing Key Patterns in Marketing Copywriting](https://claude.ai/chat/0257c0ad-0da3-4297-969e-23cd56baa561)

[View all](https://claude.ai/recents)

Professional plan

S

tlswkehd@gmail.com

S

Leveraging MongoDB Atlas Triggers for YouTube Analytics

[](https://claude.ai/new)

4

Share

shinws890810760 1ì´ˆ ì „ ëª½ê³  db ì•„í‹€ë¼ìŠ¤, ë‚  ì™„ì „íˆ ì´í•´ì‹œì¼œì¤˜ ì£„ì†¡í•©ë‹ˆë‹¤, ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤ ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”. ëª½ê³  dbì•„í‹€ë¼ìŠ¤ë¥¼ ë‚  ì™„ì „íˆ ì´í•´ì‹œì¼œì¤˜ ë‹µë³€ MongoDB AtlasëŠ” í´ë¼ìš°ë“œ ê¸°ë°˜ì˜ ì™„ì „ ê´€ë¦¬í˜• NoSQL ë°ì´í„°ë² ì´ìŠ¤ ì„œë¹„ìŠ¤ë¡œ, ê°œë°œìê°€ ì¸í”„ë¼ ê´€ë¦¬ ì—†ì´ ë¬¸ì„œ ì§€í–¥ ë°ì´í„° ëª¨ë¸ê³¼ ë¶„ì‚°

pasted

dataMath3

md

S

Edit

Based on your files, I'll provide you with a comprehensive understanding of MongoDB Atlas and how to leverage its triggers for your YouTube analytics application.

# MongoDB Atlas: A Complete Overview

MongoDB Atlas is a fully managed database-as-a-service offering that handles all the complexity of deploying, managing, and scaling MongoDB deployments in the cloud. Here's a deep dive into its capabilities and how they apply to your YouTube analytics application:

## Key Features of MongoDB Atlas

1. **Cloud-Based Infrastructure**
   * Runs on AWS, Google Cloud, and Azure across 80+ regions
   * 99.995% uptime guarantee with automatic failover
   * Eliminates the need to manage your own database servers
2. **Auto-scaling Capabilities**
   * Vertical scaling: Upgrade from M10 to larger tiers as needed
   * Horizontal scaling: Distribute data across multiple servers via sharding
   * Auto-scale clusters based on real-time traffic patterns
3. **Advanced Security**
   * Encryption at rest (AES-256) and in transit (TLS 1.3)
   * Network isolation via IP whitelisting and VPC peering
   * Role-based access control and integration with LDAP/SAML

## Leveraging Triggers for Your YouTube Analytics App

Based on your application needs and the documents you provided, here's how to effectively implement Atlas Triggers:

### Multi-Stage Trigger Architecture

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code><span class=""><span class="">flowchart TD
</span></span><span class="">    A[User Searches Keyword] --> B{Keyword in DB?}
</span><span class="">    B -->|Yes| C[Return Cached Data]
</span><span class="">    B -->|No| D[Trigger 1: YouTube API/Scraping]
</span><span class="">    D --> E[Trigger 2: AI Analysis]
</span><span class="">    E --> F[Save Results to DB]
</span><span class="">    F --> G[Notify User]
</span><span class="">    H[Trigger 3: Data Freshness] --> D</span></code></div></div></div></pre>

### 1. Data Acquisition Trigger

This trigger activates when a new keyword is searched but not found in your database:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">changeEvent</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> newKeyword </span><span class="token operator">=</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// Check if we need to fetch new data</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> exists </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"videos"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">count</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">keyword</span><span class="token operator">:</span><span class=""> newKeyword</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">exists </span><span class="token operator">===</span><span class=""></span><span class="token number">0</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Option 1: Using YouTube API</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> youtubeData </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">http</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">url</span><span class="token operator">:</span><span class=""></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://www.googleapis.com/youtube/v3/search?part=snippet&q=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">newKeyword</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&key=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">context</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">values</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation method function property-access">get</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation string">"YOUTUBE_API_KEY"</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&type=video&maxResults=10</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">encodeBodyAsJSON</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// Option 2: Trigger serverless function for web scraping</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">functions</span><span class="token punctuation">.</span><span class="token method function property-access">execute</span><span class="token punctuation">(</span><span class="token string">"runPlaywrightScraper"</span><span class="token punctuation">,</span><span class=""> newKeyword</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// Update status to processing</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">keyword</span><span class="token operator">:</span><span class=""> newKeyword </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

### 2. AI Analysis Trigger (Scheduled)

This runs every few minutes to process any pending data:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Find all keywords with status "0" (processing)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> pendingKeywords </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class=""></span><span class="token comment">// Process in batches</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> keywordDoc </span><span class="token keyword">of</span><span class=""> pendingKeywords</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Get video data</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"videos"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">keyword</span><span class="token operator">:</span><span class=""> keywordDoc</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">round_no</span><span class="token operator">:</span><span class=""> keywordDoc</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">videos</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token operator">></span><span class=""></span><span class="token number">0</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Run AI analysis on videos</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Calculate hook index, growth index as defined in your dataMath3.md</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> video </span><span class="token keyword">of</span><span class=""> videos</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> hookIndex </span><span class="token operator">=</span><span class=""></span><span class="token function">calculateHookIndex</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class="token punctuation">,</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">subscribers</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> growthIndex </span><span class="token operator">=</span><span class=""></span><span class="token function">calculateGrowthIndex</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class="token punctuation">,</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">publishDate</span><span class="token punctuation">,</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">subscribers</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class=""></span><span class="token comment">// Update video with analysis</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"videos"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">              hookIndex</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">              growthIndex</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">exposureProbability</span><span class="token operator">:</span><span class=""></span><span class="token function">calculateExposureProbability</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class="token punctuation">,</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">subscribers</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">analysisComplete</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// Mark keyword as complete</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> keywordDoc</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

### 3. Data Freshness Trigger (Daily)

This runs once a day to keep data fresh:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Find keywords with old data (older than 7 days)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> oldKeywords </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$lt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">-</span><span class=""></span><span class="token number">7</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">limit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class=""></span><span class="token comment">// Process in batches</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> keyword </span><span class="token keyword">of</span><span class=""> oldKeywords</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Mark for refresh</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> keyword</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">scheduler_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"Y"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

## Optimizing Triggers for Performance and Cost

1. **Efficient Data Fetching**
   * Use batch operations whenever possible (process multiple items in one trigger execution)
   * Implement incremental updates (only fetch changes since last update)
   * Cache common AI analysis results
2. **Error Handling and Retry Logic**
   <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// Your trigger code</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// Log the error</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">Error processing keyword: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// Implement exponential backoff retry</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">retryCount </span><span class="token operator"><</span><span class=""></span><span class="token number">3</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"retryQueue"</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class="">        keyword</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token literal-property property">retryCount</span><span class="token operator">:</span><span class=""> retryCount </span><span class="token operator">+</span><span class=""></span><span class="token number">1</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token literal-property property">nextRetry</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class=""> retryCount</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token literal-property property">error</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// Mark as failed after max retries</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> keyword </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"2"</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">errorMessage</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>
3. **Rate Limiting for External APIs**
   * Implement throttling to avoid YouTube API quota limits
   * Track daily API usage and adjust processing rates

## Integration with Your NextJS Application

Since you're using NextJS, you can integrate this with your API routes:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// pages/api/youtube/search/[keyword].ts</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token keyword">type</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token maybe-class-name">NextApiRequest</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">NextApiResponse</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> connectToDatabase </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'../../../../lib/mongodb'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">handler</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class="">  req</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextApiRequest</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">  res</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextApiResponse</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">query</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> db </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">connectToDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// Check if we have this keyword cached</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> existingKeyword </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">existingKeyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Return cached data</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'videos'</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> round_no</span><span class="token operator">:</span><span class=""> existingKeyword</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> videos</span><span class="token punctuation">,</span><span class=""> history</span><span class="token operator">:</span><span class=""> existingKeyword </span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// Create new keyword request</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> newKeyword </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    newKeyword</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    country</span><span class="token operator">:</span><span class=""></span><span class="token string">"KR"</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">    lang</span><span class="token operator">:</span><span class=""></span><span class="token string">"ko"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    round_no</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    uid</span><span class="token operator">:</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">[</span><span class="token string">'user-id'</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">'anonymous'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    create_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">insertOne</span><span class="token punctuation">(</span><span class="">newKeyword</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// The trigger will handle the YouTube API call and processing</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">      history</span><span class="token operator">:</span><span class=""> newKeyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      message</span><span class="token operator">:</span><span class=""></span><span class="token string">'Your request is being processed. Check back shortly.'</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

## Key Advantages for Your Use Case

1. **Reduced Backend Complexity** : Triggers handle the complex processing flow without you needing to maintain separate workers or queues.
2. **Cost Efficiency** : Only pay for processing when needed, rather than running always-on servers.
3. **Scalability** : Automatically scales to handle traffic spikes without additional configuration.
4. **Maintainability** : Centralized logic in triggers makes it easier to update processing pipelines.

By leveraging MongoDB Atlas triggers for your YouTube analytics application, you can create a more responsive, scalable system that efficiently manages the data acquisition, processing, and analysis workflow while keeping costs under control.

Retry

S

í•œêµ­ì–´ë¡œ ëŒ€ë‹µí•´.
ê·¸ëŸ¼, ì‚¬ìš©ìê°€ í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰í•˜ìë§ˆì, triggersì—ì„œ ë°”ë¡œ í•´ë‹¹ í‚¤ì›Œë“œë¥¼ apiì—ìš”ì²­í•˜ëŠ” ê²ƒë„ ì¢‹ì§€ë§Œ, ì§ì ‘ ë¸Œë¼ìš°ì§•ì„ í•´ì„œ ë” ìƒì„¸í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ë©´, êµ¬ê¸€apiì—ì„œ ì œí•œí•˜ëŠ” apií˜¸ì¶œ ì‚¬ìš©ëŸ‰ ì œí•œì— ê±¸ë¦¬ì§€ë„ ì•Šì„ê²ƒê°™ì•„. ì‹¤ì œ ë¸Œë¼ìš°ì§•ì´ë‚˜ í¬ë¡¤ë§ì„ triggerë¡œ ì‹¤í–‰í•˜ëŠ” ê±¸ ë§í•˜ëŠ”ê±°ì•¼

Edit

MongoDB Atlas íŠ¸ë¦¬ê±°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œ ë¸Œë¼ìš°ì§•ì´ë‚˜ í¬ë¡¤ë§ì„ ì‹¤í–‰í•˜ëŠ” ì ‘ê·¼ ë°©ì‹ì€ ë§¤ìš° íš¨ê³¼ì ì¸ ì „ëµì…ë‹ˆë‹¤. ì´ ë°©ë²•ì„ í†µí•´ YouTube API í˜¸ì¶œ ì œí•œì„ ìš°íšŒí•˜ë©´ì„œ ë” í’ë¶€í•œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## MongoDB Atlas íŠ¸ë¦¬ê±°ë¡œ ë¸Œë¼ìš°ì € ìë™í™” êµ¬í˜„í•˜ê¸°

MongoDB Atlasì˜ íŠ¸ë¦¬ê±° ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ Playwrightë‚˜ Selenium ê°™ì€ ë¸Œë¼ìš°ì € ìë™í™” ë„êµ¬ë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤:

### 1. ì•„í‚¤í…ì²˜ êµ¬ì„±

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code><span class=""><span class="">ì‚¬ìš©ì ê²€ìƒ‰ ìš”ì²­ â†’ MongoDB ì´ë²¤íŠ¸ ë°œìƒ â†’ Atlas íŠ¸ë¦¬ê±° í™œì„±í™” â†’ ì™¸ë¶€ ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜ í˜¸ì¶œ â†’ ë¸Œë¼ìš°ì € ìë™í™” ì‹¤í–‰ â†’ ê²°ê³¼ ì €ì¥</span></span></code></div></div></div></pre>

### 2. êµ¬í˜„ ë°©ë²• (2ê°€ì§€ ì ‘ê·¼ë²•)

#### ë°©ë²• 1: AWS Lambda ì—°ë™

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// MongoDB Atlas íŠ¸ë¦¬ê±° í•¨ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">changeEvent</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> keyword </span><span class="token operator">=</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// AWS Lambda í•¨ìˆ˜ í˜¸ì¶œ (ë¸Œë¼ìš°ì € ìë™í™” ì‹¤í–‰)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">http</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">url</span><span class="token operator">:</span><span class=""></span><span class="token string">"https://your-aws-region.amazonaws.com/lambda-function"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">headers</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string-property property">"Content-Type"</span><span class="token operator">:</span><span class=""></span><span class="token string">"application/json"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string-property property">"x-api-key"</span><span class="token operator">:</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">values</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"AWS_API_KEY"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">keyword</span><span class="token operator">:</span><span class=""> keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">historyId</span><span class="token operator">:</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í¬ë¡¤ë§ ì‘ì—… ì‹œì‘ í‘œì‹œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">crawling_status</span><span class="token operator">:</span><span class=""></span><span class="token string">"processing"</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

AWS Lambdaì—ì„œëŠ” Chromeì„ headless ëª¨ë“œë¡œ ì‹¤í–‰í•˜ëŠ” Playwright/Selenium ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ë™ì‹œí‚µë‹ˆë‹¤:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// AWS Lambda í•¨ìˆ˜ (Node.js)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> chromium </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'playwright-aws-lambda'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token maybe-class-name">MongoClient</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class="">exports</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">handler</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> historyId </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span><span class="">event</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> browser</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// Playwright ë¸Œë¼ìš°ì € ì‹¤í–‰</span><span class="">
</span></span><span class=""><span class="">    browser </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> chromium</span><span class="token punctuation">.</span><span class="token method function property-access">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> context </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> browser</span><span class="token punctuation">.</span><span class="token method function property-access">newContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> page </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token method function property-access">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// YouTube ì ‘ì† ë° ê²€ìƒ‰</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">goto</span><span class="token punctuation">(</span><span class="token string">'https://www.youtube.com/results?search_query='</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="">keyword</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForSelector</span><span class="token punctuation">(</span><span class="token string">'ytd-video-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ì •ë³´ ì¶”ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> results </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> items </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'ytd-video-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class="">      items</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videoId </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'a#thumbnail'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'v='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'&'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> title </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#video-title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">textContent</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> views </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#metadata-line span:first-child'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">textContent</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> publishTime </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#metadata-line span:last-child'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">textContent</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelName </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#channel-name a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">textContent</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelId </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#channel-name a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'/channel/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> thumbnail </span><span class="token operator">=</span><span class=""></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://i.ytimg.com/vi/</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">videoId</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">/hqdefault.jpg</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class="">        results</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          videoId</span><span class="token punctuation">,</span><span class=""> title</span><span class="token punctuation">,</span><span class=""> views</span><span class="token punctuation">,</span><span class=""> publishTime</span><span class="token punctuation">,</span><span class=""> channelName</span><span class="token punctuation">,</span><span class=""> channelId</span><span class="token punctuation">,</span><span class=""> thumbnail
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> results</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì±„ë„ ìƒì„¸ ì •ë³´ ìˆ˜ì§‘ (êµ¬ë…ì ìˆ˜ ë“±)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> video </span><span class="token keyword">of</span><span class=""> videos</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">goto</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://www.youtube.com/channel/</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">video</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">channelId</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForSelector</span><span class="token punctuation">(</span><span class="token string">'#subscriber-count'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> subscribers </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">$eval</span><span class="token punctuation">(</span><span class="token string">'#subscriber-count'</span><span class="token punctuation">,</span><span class=""></span><span class="token parameter">el</span><span class=""></span><span class="token arrow operator">=></span><span class=""> el</span><span class="token punctuation">.</span><span class="token property-access">textContent</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">      video</span><span class="token punctuation">.</span><span class="token property-access">subscribers</span><span class=""></span><span class="token operator">=</span><span class=""> subscribers</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// MongoDBì— ê²°ê³¼ ì €ì¥</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> client </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">MongoClient</span><span class="token punctuation">(</span><span class="">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">MONGODB_URI</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> db </span><span class="token operator">=</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">'youtube_analytics'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ë°ì´í„° ì €ì¥</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'videos'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">insertMany</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class="">      videos</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">video</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token spread operator">...</span><span class="">video</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        historyId</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">createdAt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">MongoDB</span><span class="token punctuation">.</span><span class="token method function property-access maybe-class-name">ObjectId</span><span class="token punctuation">(</span><span class="">historyId</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">crawling_status</span><span class="token operator">:</span><span class=""></span><span class="token string">"completed"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">video_count</span><span class="token operator">:</span><span class=""> videos</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">completed_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">statusCode</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">success</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">videoCount</span><span class="token operator">:</span><span class=""> videos</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'í¬ë¡¤ë§ ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ê¸°ë¡</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> client </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">MongoClient</span><span class="token punctuation">(</span><span class="">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">MONGODB_URI</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">'youtube_analytics'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">MongoDB</span><span class="token punctuation">.</span><span class="token method function property-access maybe-class-name">ObjectId</span><span class="token punctuation">(</span><span class="">historyId</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">crawling_status</span><span class="token operator">:</span><span class=""></span><span class="token string">"failed"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">error</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">statusCode</span><span class="token operator">:</span><span class=""></span><span class="token number">500</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">success</span><span class="token operator">:</span><span class=""></span><span class="token boolean">false</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">error</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">finally</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">browser</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> browser</span><span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

#### ë°©ë²• 2: ì „ìš© í¬ë¡¤ë§ ì„œë²„ êµ¬ì¶•

ë” ë³µì¡í•œ í¬ë¡¤ë§ì´ í•„ìš”í•˜ë‹¤ë©´ ì „ìš© ì„œë²„ë¥¼ êµ¬ì¶•í•˜ê³  API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë§Œë“¤ì–´ Atlas íŠ¸ë¦¬ê±°ì—ì„œ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// MongoDB Atlas íŠ¸ë¦¬ê±°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">changeEvent</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> keyword </span><span class="token operator">=</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì „ìš© í¬ë¡¤ë§ ì„œë²„ API í˜¸ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">http</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">url</span><span class="token operator">:</span><span class=""></span><span class="token string">"https://your-crawling-server.com/api/crawl"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">headers</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token string-property property">"Content-Type"</span><span class="token operator">:</span><span class=""></span><span class="token string">"application/json"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">keyword</span><span class="token operator">:</span><span class=""> keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">historyId</span><span class="token operator">:</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">apiKey</span><span class="token operator">:</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">values</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"CRAWLER_API_KEY"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

### 3. ìµœì í™” ë° ì£¼ì˜ì‚¬í•­

1. **IP ì°¨ë‹¨ ë°©ì§€**
   <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// ë¸Œë¼ìš°ì € ì„¤ì •ì— User-Agent íšŒì „ ë° íƒ€ì„ì•„ì›ƒ ì¶”ê°€</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> browser </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> chromium</span><span class="token punctuation">.</span><span class="token method function property-access">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> context </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> browser</span><span class="token punctuation">.</span><span class="token method function property-access">newContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token literal-property property">userAgent</span><span class="token operator">:</span><span class=""></span><span class="token function">getRandomUserAgent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token literal-property property">viewport</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">width</span><span class="token operator">:</span><span class=""></span><span class="token number">1920</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">height</span><span class="token operator">:</span><span class=""></span><span class="token number">1080</span><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">
   </span><span class=""><span class=""></span><span class="token comment">// ìš”ì²­ ê°„ ëœë¤ ì§€ì—° ì¶”ê°€</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForTimeout</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">floor</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">3000</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></div></div></div></pre>
2. **í¬ë¡¤ë§ ê²°ê³¼ ê²€ì¦**
   <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// ë°ì´í„° ê²€ì¦ í•¨ìˆ˜</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">validateVideoData</span><span class="token punctuation">(</span><span class="token parameter">video</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">videoId</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token operator">!</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">throw</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'í•„ìˆ˜ ë°ì´í„° ëˆ„ë½: '</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// ì¡°íšŒìˆ˜ ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜ (ì˜ˆ: "1.2ë§ŒíšŒ" â†’ 12000)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'string'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class="">    video</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">parseKoreanNumberFormat</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> video</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>
3. **ìì› ê´€ë¦¬**
   <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// ë¸Œë¼ìš°ì € ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ì—¬ ì‹œì‘ ì‹œê°„ ë‹¨ì¶•</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> browser</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">
   </span><span class=""><span class="">exports</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">handler</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// ë¸Œë¼ìš°ì €ê°€ ì—†ìœ¼ë©´ ì‹œì‘</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">browser</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class="">      browser </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> chromium</span><span class="token punctuation">.</span><span class="token method function property-access">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> context </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> browser</span><span class="token punctuation">.</span><span class="token method function property-access">newContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// í¬ë¡¤ë§ ì‘ì—…...</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¸Œë¼ìš°ì € ì¬ì‹œì‘</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">browser</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> browser</span><span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class="">      browser </span><span class="token operator">=</span><span class=""></span><span class="token keyword null nil">null</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

### 4. ì‹¤ì œ êµ¬í˜„ ì‚¬ë¡€

ë·°íŠ¸ë©(ViewTrap) ê°™ì€ ì„œë¹„ìŠ¤ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// MongoDB Atlas íŠ¸ë¦¬ê±° í•¨ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">changeEvent</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> uid </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// 1. í‚¤ì›Œë“œ ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ í¬ë¡¤ë§</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> crawlerResponse </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">http</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">url</span><span class="token operator">:</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">CRAWLER_SERVICE_URL</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">action</span><span class="token operator">:</span><span class=""></span><span class="token string">"search_results"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> searchResults </span><span class="token operator">=</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span><span class="">crawlerResponse</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// 2. MongoDBì— ì´ˆê¸° ê²°ê³¼ ì €ì¥</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"viewtrap"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"videos"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">insertMany</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class="">      searchResults</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">video</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token spread operator">...</span><span class="">video</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"partial"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ë¶€ë¶„ ë°ì´í„°ë§Œ ìˆ˜ì§‘ëœ ìƒíƒœ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">created_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// 3. ê°œë³„ ë¹„ë””ì˜¤ ìƒì„¸ ì •ë³´ ìˆ˜ì§‘ (ë¹„ë™ê¸° ì‘ì—… ì˜ˆì•½)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> video </span><span class="token keyword">of</span><span class=""> searchResults</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"viewtrap"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"crawlQueue"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">videoId</span><span class="token operator">:</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">videoId</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">type</span><span class="token operator">:</span><span class=""></span><span class="token string">"video_details"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"pending"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">created_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// 4. í‚¤ì›Œë“œ ìƒíƒœ ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"viewtrap"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">initial_crawl_complete</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">video_count</span><span class="token operator">:</span><span class=""> searchResults</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

ë‹¤ìŒìœ¼ë¡œ í¬ë¡¤ë§ íë¥¼ ì²˜ë¦¬í•˜ëŠ” ë³„ë„ì˜ ì˜ˆì•½ íŠ¸ë¦¬ê±°ë¥¼ ë§Œë“­ë‹ˆë‹¤:

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// ì •ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” í¬ë¡¤ë§ í ì²˜ë¦¬ íŠ¸ë¦¬ê±°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> db </span><span class="token operator">=</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"viewtrap"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì²˜ë¦¬í•  ì‘ì—… ê°€ì ¸ì˜¤ê¸°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> pendingTasks </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"crawlQueue"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"pending"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> task </span><span class="token keyword">of</span><span class=""> pendingTasks</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì‘ì—… ìƒíƒœ ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"crawlQueue"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> task</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"processing"</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">started_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// í¬ë¡¤ë§ ì‘ì—… ì‹¤í–‰</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">http</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">url</span><span class="token operator">:</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">CRAWLER_SERVICE_URL</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">videoId</span><span class="token operator">:</span><span class=""> task</span><span class="token punctuation">.</span><span class="token property-access">videoId</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">action</span><span class="token operator">:</span><span class=""></span><span class="token string">"video_details"</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videoDetails </span><span class="token operator">=</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span><span class="">response</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ì •ë³´ ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"videos"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">videoId</span><span class="token operator">:</span><span class=""> task</span><span class="token punctuation">.</span><span class="token property-access">videoId</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">keyword</span><span class="token operator">:</span><span class=""> task</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token spread operator">...</span><span class="">videoDetails</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"complete"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">hookIndex</span><span class="token operator">:</span><span class=""></span><span class="token function">calculateHookIndex</span><span class="token punctuation">(</span><span class="">videoDetails</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class="token punctuation">,</span><span class=""> videoDetails</span><span class="token punctuation">.</span><span class="token property-access">subscribers</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">growthIndex</span><span class="token operator">:</span><span class=""></span><span class="token function">calculateGrowthIndex</span><span class="token punctuation">(</span><span class="">videoDetails</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class="token punctuation">,</span><span class=""> videoDetails</span><span class="token punctuation">.</span><span class="token property-access">publishDate</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">updated_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ì‘ì—… ì™„ë£Œ í‘œì‹œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"crawlQueue"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> task</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"completed"</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">completed_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ì²˜ë¦¬</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"crawlQueue"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> task</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"failed"</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">error</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">failed_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ëª¨ë“  ë¹„ë””ì˜¤ê°€ ì²˜ë¦¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  í‚¤ì›Œë“œ ìƒíƒœ ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> keywords </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">initial_crawl_complete</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> keyword </span><span class="token keyword">of</span><span class=""> keywords</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> pendingVideos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"videos"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">count</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">keyword</span><span class="token operator">:</span><span class=""> keyword</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"partial"</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">pendingVideos </span><span class="token operator">===</span><span class=""></span><span class="token number">0</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ëª¨ë“  ë¹„ë””ì˜¤ ì²˜ë¦¬ ì™„ë£Œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> keyword</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">completed_at</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

ì´ëŸ¬í•œ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ YouTube API ì œí•œì„ í”¼í•˜ë©´ì„œë„ í’ë¶€í•œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆìœ¼ë©°, ì²˜ë¦¬ ì‘ì—…ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë¶„ì‚°í•˜ì—¬ ì‹œìŠ¤í…œì˜ í™•ì¥ì„±ê³¼ ì•ˆì •ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Retry

S

ì´ˆë°˜ì— ì²¨ë¶€í•œ ë‚´ ë¬¸ì„œ datamath3.md ë¥¼ ì½ì–´ë´. ë‚´ ì„œë¹„ìŠ¤ì˜ ë°ì´í„° êµ¬ì¡°ë¥¼ ëª¨ë‘ ì •í™•í•˜ê²Œ íŒŒì•…í•œ ë’¤, ë¸Œë¼ìš°ì € ìŠ¤í¬ë˜í•‘ìœ¼ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì‹¤ì œë¡œ êµ¬ì²´ì ìœ¼ë¡œ ì½”ë“œì— ì ìš©í•´ì„œ ì•Œë ¤ì£¼ê³  ë” ê°œì„ í•´ì¤„ ìœ ì €í”Œë¡œìš°ì™€ ì‚¬ìš©ìê²½í—˜ì„ ê·¹ëŒ€í™”ì‹œì¼œì£¼ëŠ” í”„ë¡ íŠ¸ ìŠ¤í‚¬ ì„±ê³µì‚¬ë¡€ë“¤ë„ ì•Œë ¤ì£¼ë©´ ê³ ë§ˆìš¸ê±°ê°™ì•„

Edit

ë„¤, dataMath3.md íŒŒì¼ì„ ê²€í† í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ íŒŒì¼ì—ëŠ” YouTube API v3ì™€ ê´€ë ¨ëœ ë°ì´í„° ë§¤í•‘ ë° í†µí•© ë°©ë²•ì— ëŒ€í•œ ìƒì„¸í•œ ë‚´ìš©ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ì œ ê·€í•˜ì˜ ì„œë¹„ìŠ¤ ë°ì´í„° êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ê³  ë¸Œë¼ìš°ì € ìŠ¤í¬ë˜í•‘ ì†”ë£¨ì…˜ì„ ì œê³µí•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

# ì„œë¹„ìŠ¤ ë°ì´í„° êµ¬ì¡° ë¶„ì„

## í•µì‹¬ ëª¨ë¸

1. **KeywordHistory** - ì‚¬ìš©ì ê²€ìƒ‰ ê¸°ë¡ ê´€ë¦¬
   * ìƒíƒœ ì½”ë“œ: "0"(ì²˜ë¦¬ ì¤‘), "1"(ì™„ë£Œ), "2"(ì‹¤íŒ¨)
   * ê´€ë ¨ í•„ë“œ: round_no, keyword, status, uid ë“±
2. **Video** - ë¹„ë””ì˜¤ ìƒì„¸ ì •ë³´
   * í•„ìˆ˜ í•„ë“œ: videoId, title, thumbnail, duration, views ë“±
   * ê³„ì‚° í•„ë“œ: hookIndex, growthIndex, exposureProbability
3. **User** - ì‚¬ìš©ì ì •ë³´ ê´€ë¦¬
4. **MembershipLimit** - ë©¤ë²„ì‹­ë³„ ì‚¬ìš© ì œí•œ ê´€ë¦¬

## í”„ë¡œì„¸ìŠ¤ íë¦„

1. ì‚¬ìš©ìê°€ í‚¤ì›Œë“œ ê²€ìƒ‰
2. KeywordHistory ìƒì„± (status: "0")
3. ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë¹„ë””ì˜¤ ë°ì´í„° ìˆ˜ì§‘
4. ë¶„ì„ ë° ì§€ìˆ˜ ê³„ì‚°
5. ê²°ê³¼ ë°˜í™˜ (status: "1")

# ë¸Œë¼ìš°ì € ìŠ¤í¬ë˜í•‘ ì†”ë£¨ì…˜

ë¨¼ì € MongoDB Atlas íŠ¸ë¦¬ê±°ì™€ Playwrightë¥¼ í™œìš©í•œ ìŠ¤í¬ë˜í•‘ ì†”ë£¨ì…˜ì„ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤.

## 1. í‚¤ì›Œë“œ ê²€ìƒ‰ ê²°ê³¼ ìŠ¤í¬ë˜í•‘ íŠ¸ë¦¬ê±°

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token function-variable function">exports</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">changeEvent</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ìƒˆ í‚¤ì›Œë“œ ê²€ìƒ‰ íŠ¸ë¦¬ê±° (KeywordHistory ì»¬ë ‰ì…˜ì— ìƒˆ ë¬¸ì„œ ì¶”ê°€ ì‹œ ì‹¤í–‰)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> round_no</span><span class="token punctuation">,</span><span class=""> uid </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ìŠ¤í¬ë˜í•‘ ì„œë²„ í˜¸ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">http</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">url</span><span class="token operator">:</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">values</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"SCRAPING_SERVICE_URL"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">headers</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string-property property">"Content-Type"</span><span class="token operator">:</span><span class=""></span><span class="token string">"application/json"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string-property property">"Authorization"</span><span class="token operator">:</span><span class=""></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">Bearer </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">context</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">values</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation method function property-access">get</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation string">"SCRAPING_SERVICE_TOKEN"</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">task</span><span class="token operator">:</span><span class=""></span><span class="token string">"youtube_search"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">params</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">maxResults</span><span class="token operator">:</span><span class=""></span><span class="token number">20</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì‘ë‹µ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">response</span><span class="token punctuation">.</span><span class="token property-access">statusCode</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token number">202</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ìš”ì²­ ìˆ˜ë½ë¨ (ë¹„ë™ê¸° ì²˜ë¦¬ ì‹œì‘)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">ìŠ¤í¬ë˜í•‘ ì‘ì—… ì‹œì‘: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">, round_no: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">round_no</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ë°œìƒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">throw</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤ ì˜¤ë¥˜: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">response</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">statusCode</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ê¸°ë¡</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">í‚¤ì›Œë“œ </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// KeywordHistory ìƒíƒœ ì—…ë°ì´íŠ¸ - ì‹¤íŒ¨</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token property-access">services</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"mongodb-atlas"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">"youtube_analytics"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"keywordHistory"</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class=""> changeEvent</span><span class="token punctuation">.</span><span class="token property-access">fullDocument</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"2"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì‹¤íŒ¨</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">error_message</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

## 2. ìŠ¤í¬ë˜í•‘ ì„œë²„ êµ¬í˜„ (Playwright)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">javascript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-javascript"><span class=""><span class="token comment">// scraping-service.js</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> express </span><span class="token operator">=</span><span class=""></span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token maybe-class-name">MongoClient</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">ObjectId</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> chromium </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'playwright'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> app </span><span class="token operator">=</span><span class=""></span><span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="">express</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// í™˜ê²½ ë³€ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token constant">MONGODB_URI</span><span class=""></span><span class="token operator">=</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">MONGODB_URI</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token constant">PORT</span><span class=""></span><span class="token operator">=</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">PORT</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token number">3001</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token constant">API_TOKEN</span><span class=""></span><span class="token operator">=</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">API_TOKEN</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì¸ì¦ ë¯¸ë“¤ì›¨ì–´</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">authenticate</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> res</span><span class="token parameter punctuation">,</span><span class="token parameter"> next</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> authHeader </span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">.</span><span class="token property-access">authorization</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">authHeader </span><span class="token operator">||</span><span class=""></span><span class="token operator">!</span><span class="">authHeader</span><span class="token punctuation">.</span><span class="token method function property-access">startsWith</span><span class="token punctuation">(</span><span class="token string">'Bearer '</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""> authHeader</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">!==</span><span class=""></span><span class="token constant">API_TOKEN</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">error</span><span class="token operator">:</span><span class=""></span><span class="token string">'ì¸ì¦ ì‹¤íŒ¨'</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// YouTube ê²€ìƒ‰ ê²°ê³¼ ìŠ¤í¬ë˜í•‘</span><span class="">
</span></span><span class=""><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/api/scrape'</span><span class="token punctuation">,</span><span class=""> authenticate</span><span class="token punctuation">,</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> res</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> task</span><span class="token punctuation">,</span><span class=""> params </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">task </span><span class="token operator">!==</span><span class=""></span><span class="token string">'youtube_search'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">error</span><span class="token operator">:</span><span class=""></span><span class="token string">'ì§€ì›í•˜ì§€ ì•ŠëŠ” ì‘ì—…'</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> round_no</span><span class="token punctuation">,</span><span class=""> uid</span><span class="token punctuation">,</span><span class=""> maxResults </span><span class="token operator">=</span><span class=""></span><span class="token number">10</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> params</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì‘ì—… ìˆ˜ë½ ì‘ë‹µ</span><span class="">
</span></span><span class=""><span class="">  res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">202</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">message</span><span class="token operator">:</span><span class=""></span><span class="token string">'ì‘ì—… ìˆ˜ë½ë¨'</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">task_id</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">ObjectId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë™ê¸°ë¡œ ìŠ¤í¬ë˜í•‘ ìˆ˜í–‰</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">(</span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> browser</span><span class="token punctuation">,</span><span class=""> client</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// MongoDB ì—°ê²°</span><span class="">
</span></span><span class=""><span class="">      client </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">MongoClient</span><span class="token punctuation">(</span><span class="token constant">MONGODB_URI</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> db </span><span class="token operator">=</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">'youtube_analytics'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ë¸Œë¼ìš°ì € ì‹œì‘</span><span class="">
</span></span><span class=""><span class="">      browser </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> chromium</span><span class="token punctuation">.</span><span class="token method function property-access">launch</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">headless</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> context </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> browser</span><span class="token punctuation">.</span><span class="token method function property-access">newContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">userAgent</span><span class="token operator">:</span><span class=""></span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">viewport</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">width</span><span class="token operator">:</span><span class=""></span><span class="token number">1920</span><span class="token punctuation">,</span><span class=""></span><span class="token literal-property property">height</span><span class="token operator">:</span><span class=""></span><span class="token number">1080</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// í‚¤ì›Œë“œ ê²€ìƒ‰</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> page </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> context</span><span class="token punctuation">.</span><span class="token method function property-access">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">goto</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://www.youtube.com/results?search_query=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation function">encodeURIComponent</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&sp=CAASAhAB</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""></span><span class="token comment">// ì¡°íšŒìˆ˜ ìˆœ ì •ë ¬ íŒŒë¼ë¯¸í„° ì¶”ê°€</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ì¿ í‚¤ ë™ì˜ ëŒ€í™”ìƒì ì²˜ë¦¬ (EU ì§€ì—­ ë“±ì—ì„œ í•„ìš”)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> consentButton </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForSelector</span><span class="token punctuation">(</span><span class="token string">'button[aria-label="Agree to the use of cookies and other data for the purposes described"]'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">timeout</span><span class="token operator">:</span><span class=""></span><span class="token number">5000</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">consentButton</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> consentButton</span><span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">e</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì¿ í‚¤ ëŒ€í™”ìƒìê°€ ì—†ëŠ” ê²½ìš° ë¬´ì‹œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// í˜ì´ì§€ ë¡œë”© ëŒ€ê¸°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForSelector</span><span class="token punctuation">(</span><span class="token string">'ytd-video-renderer, ytd-compact-video-renderer'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">timeout</span><span class="token operator">:</span><span class=""></span><span class="token number">10000</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ìŠ¤í¬ë¡¤ ë‹¤ìš´í•˜ì—¬ ë” ë§ì€ ê²°ê³¼ ë¡œë“œ (maxResultsì— ë§ê²Œ)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> scrolls </span><span class="token operator">=</span><span class=""></span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">ceil</span><span class="token punctuation">(</span><span class="">maxResults </span><span class="token operator">/</span><span class=""></span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""></span><span class="token comment">// í•œ ë²ˆ ìŠ¤í¬ë¡¤ì— ì•½ 5ê°œ ê²°ê³¼ê°€ ë¡œë“œëœë‹¤ê³  ê°€ì •</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">let</span><span class=""> i </span><span class="token operator">=</span><span class=""></span><span class="token number">0</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator"><</span><span class=""> scrolls</span><span class="token punctuation">;</span><span class=""> i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">scrollBy</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class=""></span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForTimeout</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""></span><span class="token comment">// ë¡œë”© ëŒ€ê¸°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ì •ë³´ ì¶”ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> results </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> items </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'ytd-video-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class="">        items</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ID ì¶”ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videoElement </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'a#thumbnail'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videoUrl </span><span class="token operator">=</span><span class=""> videoElement</span><span class="token operator">?.</span><span class="">href </span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videoId </span><span class="token operator">=</span><span class=""> videoUrl</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'v='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'&'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ì œëª©</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> titleElement </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#video-title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> title </span><span class="token operator">=</span><span class=""> titleElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ì¸ë„¤ì¼</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> thumbnailElement </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#thumbnail img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> thumbnail </span><span class="token operator">=</span><span class=""> thumbnailElement</span><span class="token operator">?.</span><span class="">src </span><span class="token operator">||</span><span class=""></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://i.ytimg.com/vi/</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">videoId</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">/hqdefault.jpg</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ì±„ë„ ì •ë³´</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelElement </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#channel-info a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelTitle </span><span class="token operator">=</span><span class=""> channelElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelUrl </span><span class="token operator">=</span><span class=""> channelElement</span><span class="token operator">?.</span><span class="">href </span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelId </span><span class="token operator">=</span><span class=""> channelUrl</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'/channel/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ë©”íƒ€ë°ì´í„° (ì¡°íšŒìˆ˜, ì—…ë¡œë“œ ì‹œê°„)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> metadataElements </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'#metadata-line span'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> views </span><span class="token operator">=</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> publishTime </span><span class="token operator">=</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">metadataElements</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token operator">>=</span><span class=""></span><span class="token number">2</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">              views </span><span class="token operator">=</span><span class=""> metadataElements</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">              publishTime </span><span class="token operator">=</span><span class=""> metadataElements</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">videoId </span><span class="token operator">&&</span><span class=""> title</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">              results</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">                videoId</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">                title</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">                thumbnail</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">                channelId</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">                channelTitle</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">                views</span><span class="token punctuation">,</span><span class="">
</span></span><span class="">                publishTime
</span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">e</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ê°œë³„ ì•„ì´í…œ ì²˜ë¦¬ ì˜¤ë¥˜ ë¬´ì‹œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> results</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ë³„ ìƒì„¸ ì •ë³´ ìˆ˜ì§‘</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videoDetails </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> video </span><span class="token keyword">of</span><span class=""> videos</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class=""> maxResults</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ í˜ì´ì§€ ë°©ë¬¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">goto</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://www.youtube.com/watch?v=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">video</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">videoId</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">waitUntil</span><span class="token operator">:</span><span class=""></span><span class="token string">'domcontentloaded'</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForSelector</span><span class="token punctuation">(</span><span class="token string">'#info-contents'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">timeout</span><span class="token operator">:</span><span class=""></span><span class="token number">5000</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">        
</span><span class=""><span class=""></span><span class="token comment">// ì¶”ê°€ ì •ë³´ ì¶”ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> details </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì¢‹ì•„ìš” ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> likeElement </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#top-level-buttons-computed ytd-toggle-button-renderer:first-child #text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> likes </span><span class="token operator">=</span><span class=""> likeElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ì˜ìƒ ì„¤ëª…</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> descriptionElement </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#description-inline-expander'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> description </span><span class="token operator">=</span><span class=""> descriptionElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ì˜ìƒ ê¸¸ì´</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> durationElement </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'.ytp-time-duration'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> duration </span><span class="token operator">=</span><span class=""> durationElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">{</span><span class=""> likes</span><span class="token punctuation">,</span><span class=""> description</span><span class="token punctuation">,</span><span class=""> duration </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">        
</span><span class=""><span class=""></span><span class="token comment">// ì±„ë„ í˜ì´ì§€ ë°©ë¬¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">goto</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://www.youtube.com/channel/</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">video</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">channelId</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">waitUntil</span><span class="token operator">:</span><span class=""></span><span class="token string">'domcontentloaded'</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForSelector</span><span class="token punctuation">(</span><span class="token string">'#channel-header'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token literal-property property">timeout</span><span class="token operator">:</span><span class=""></span><span class="token number">5000</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">        
</span><span class=""><span class=""></span><span class="token comment">// ì±„ë„ ì •ë³´ ì¶”ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelInfo </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// êµ¬ë…ì ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> subscriberElement </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#subscriber-count'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> subscribers </span><span class="token operator">=</span><span class=""> subscriberElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ì±„ë„ ì„¤ëª…</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelDescElement </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#description-container'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> channelDescription </span><span class="token operator">=</span><span class=""> channelDescElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ì´ ë™ì˜ìƒ ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videosTabElement </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#tabsContent tp-yt-paper-tab:nth-child(2) div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> totalVideosText </span><span class="token operator">=</span><span class=""> videosTabElement</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">''</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">{</span><span class=""> subscribers</span><span class="token punctuation">,</span><span class=""> channelDescription</span><span class="token punctuation">,</span><span class=""> totalVideosText </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">        
</span><span class=""><span class=""></span><span class="token comment">// ì¢…í•© ì •ë³´ ì €ì¥</span><span class="">
</span></span><span class=""><span class="">          videoDetails</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token spread operator">...</span><span class="">video</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token spread operator">...</span><span class="">details</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token spread operator">...</span><span class="">channelInfo</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">subscribers</span><span class="token operator">:</span><span class=""> channelInfo</span><span class="token punctuation">.</span><span class="token property-access">subscribers</span><span class="token punctuation">,</span><span class="">
</span></span><span class="">          
</span><span class=""><span class=""></span><span class="token comment">// ë·°íŠ¸ë© ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê³„ì‚° ì§€ìˆ˜ ì¶”ê°€</span><span class="">
</span></span><span class=""><span class="">            round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì™„ë£Œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">e</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">ë¹„ë””ì˜¤ </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">video</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">videoId</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> ìƒì„¸ ì •ë³´ ìˆ˜ì§‘ ì˜¤ë¥˜:</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""> e</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// MongoDBì— ë°ì´í„° ì €ì¥</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">videoDetails</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token operator">></span><span class=""></span><span class="token number">0</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ê³„ì‚°ëœ ì§€ìˆ˜ ì¶”ê°€</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> processedVideos </span><span class="token operator">=</span><span class=""> videoDetails</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">video</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì¡°íšŒìˆ˜ ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜ (ì˜ˆ: "1.2ë§ŒíšŒ" -> 12000)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> viewCount </span><span class="token operator">=</span><span class=""></span><span class="token function">parseViewCount</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">views</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> subscriberCount </span><span class="token operator">=</span><span class=""></span><span class="token function">parseSubscriberCount</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">subscribers</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">        
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token spread operator">...</span><span class="">video</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            viewCount</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            subscriberCount</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">hookIndex</span><span class="token operator">:</span><span class=""></span><span class="token function">calculateHookIndex</span><span class="token punctuation">(</span><span class="">viewCount</span><span class="token punctuation">,</span><span class=""> subscriberCount</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">growthIndex</span><span class="token operator">:</span><span class=""></span><span class="token function">calculateGrowthIndex</span><span class="token punctuation">(</span><span class="">viewCount</span><span class="token punctuation">,</span><span class=""> video</span><span class="token punctuation">.</span><span class="token property-access">publishTime</span><span class="token punctuation">,</span><span class=""> subscriberCount</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">exposureProbability</span><span class="token operator">:</span><span class=""></span><span class="token function">calculateExposureProbability</span><span class="token punctuation">(</span><span class="">viewCount</span><span class="token punctuation">,</span><span class=""> subscriberCount</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ì»¬ë ‰ì…˜ì— ë°ì´í„° ì €ì¥</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'videos'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">insertMany</span><span class="token punctuation">(</span><span class="">processedVideos</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class=""></span><span class="token comment">// KeywordHistory ìƒíƒœ ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> round_no </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì™„ë£Œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">video_count</span><span class="token operator">:</span><span class=""> processedVideos</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">recKeywords</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">extractRelatedKeywords</span><span class="token punctuation">(</span><span class="">page</span><span class="token punctuation">,</span><span class=""> keyword</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">throw</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'ë¹„ë””ì˜¤ ì •ë³´ë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">YouTube ìŠ¤í¬ë˜í•‘ ì˜¤ë¥˜:</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">client</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ìƒíƒœ ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> db </span><span class="token operator">=</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">db</span><span class="token punctuation">(</span><span class="token string">'youtube_analytics'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> round_no </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token literal-property property">status</span><span class="token operator">:</span><span class=""></span><span class="token string">"2"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì‹¤íŒ¨</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">error_message</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token literal-property property">update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">finally</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">browser</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> browser</span><span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">client</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> client</span><span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">parseViewCount</span><span class="token punctuation">(</span><span class="token parameter">viewsStr</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">viewsStr</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// "ì¡°íšŒìˆ˜ 1.2ë§ŒíšŒ" -> 12000</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> cleaned </span><span class="token operator">=</span><span class=""> viewsStr</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">[^0-9.]</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">g</span><span class="token punctuation">,</span><span class=""></span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">viewsStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ì²œ'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">viewsStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ë§Œ'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">10000</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">viewsStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ì–µ'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">100000000</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">parseSubscriberCount</span><span class="token punctuation">(</span><span class="token parameter">subscribersStr</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">subscribersStr</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// "êµ¬ë…ì 123ë§Œëª…" -> 1230000</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> cleaned </span><span class="token operator">=</span><span class=""> subscribersStr</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">[^0-9.]</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">g</span><span class="token punctuation">,</span><span class=""></span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">subscribersStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ì²œ'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">subscribersStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ë§Œ'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">10000</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">subscribersStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ì–µ'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">100000000</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">cleaned</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// dataMath3.mdì— ì •ì˜ëœ ì§€ìˆ˜ ê³„ì‚° í•¨ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">calculateHookIndex</span><span class="token punctuation">(</span><span class="token parameter">views</span><span class="token parameter punctuation">,</span><span class="token parameter"> subscribers</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">subscribers </span><span class="token operator">||</span><span class=""> subscribers </span><span class="token operator">===</span><span class=""></span><span class="token number">0</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'F'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> ratio </span><span class="token operator">=</span><span class=""> views </span><span class="token operator">/</span><span class=""> subscribers</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> hookIndex </span><span class="token operator">=</span><span class=""> ratio </span><span class="token operator">/</span><span class=""></span><span class="token number">8.3</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">hookIndex </span><span class="token operator">>=</span><span class=""></span><span class="token number">40</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'A'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">hookIndex </span><span class="token operator">>=</span><span class=""></span><span class="token number">20</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'B'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">hookIndex </span><span class="token operator">>=</span><span class=""></span><span class="token number">10</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'C'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">hookIndex </span><span class="token operator">>=</span><span class=""></span><span class="token number">5</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'D'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'F'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">calculateGrowthIndex</span><span class="token punctuation">(</span><span class="token parameter">views</span><span class="token parameter punctuation">,</span><span class="token parameter"> publishTimeStr</span><span class="token parameter punctuation">,</span><span class="token parameter"> subscribers</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ê²Œì‹œ ì‹œê°„ ë¬¸ìì—´ ë³€í™˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> daysSincePublish </span><span class="token operator">=</span><span class=""></span><span class="token function">parseDaysSincePublish</span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì¼í‰ê·  ì¡°íšŒìˆ˜ ê³„ì‚°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> viewsPerDay </span><span class="token operator">=</span><span class=""> views </span><span class="token operator">/</span><span class=""></span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> daysSincePublish</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì„±ì¥ ì§€ìˆ˜ ê³„ì‚°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> growthValue </span><span class="token operator">=</span><span class=""> subscribers </span><span class="token operator">></span><span class=""></span><span class="token number">0</span><span class=""></span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">viewsPerDay </span><span class="token operator">/</span><span class=""> subscribers</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">1000</span><span class=""></span><span class="token operator">:</span><span class=""></span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">growthValue </span><span class="token operator">>=</span><span class=""></span><span class="token number">800</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'A'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">growthValue </span><span class="token operator">>=</span><span class=""></span><span class="token number">300</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'B'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">growthValue </span><span class="token operator">>=</span><span class=""></span><span class="token number">100</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'C'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">growthValue </span><span class="token operator">>=</span><span class=""></span><span class="token number">50</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'D'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'F'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">calculateExposureProbability</span><span class="token punctuation">(</span><span class="token parameter">views</span><span class="token parameter punctuation">,</span><span class="token parameter"> subscribers</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">subscribers </span><span class="token operator">||</span><span class=""> subscribers </span><span class="token operator">===</span><span class=""></span><span class="token number">0</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">min</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">views </span><span class="token operator">/</span><span class=""> subscribers</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">100</span><span class="token punctuation">,</span><span class=""></span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">parseDaysSincePublish</span><span class="token punctuation">(</span><span class="token parameter">publishTimeStr</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">publishTimeStr</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token number">30</span><span class="token punctuation">;</span><span class=""></span><span class="token comment">// ê¸°ë³¸ê°’</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> now </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> days </span><span class="token operator">=</span><span class=""></span><span class="token number">30</span><span class="token punctuation">;</span><span class=""></span><span class="token comment">// ê¸°ë³¸ê°’</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ë…„'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> years </span><span class="token operator">=</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">(\d+)ë…„</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    days </span><span class="token operator">=</span><span class=""> years </span><span class="token operator">*</span><span class=""></span><span class="token number">365</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ê°œì›”'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> months </span><span class="token operator">=</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">(\d+)ê°œì›”</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    days </span><span class="token operator">=</span><span class=""> months </span><span class="token operator">*</span><span class=""></span><span class="token number">30</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ì£¼'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> weeks </span><span class="token operator">=</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">(\d+)ì£¼</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    days </span><span class="token operator">=</span><span class=""> weeks </span><span class="token operator">*</span><span class=""></span><span class="token number">7</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ì¼'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    days </span><span class="token operator">=</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">(\d+)ì¼</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ì‹œê°„'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> hours </span><span class="token operator">=</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">(\d+)ì‹œê°„</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    days </span><span class="token operator">=</span><span class=""> hours </span><span class="token operator">/</span><span class=""></span><span class="token number">24</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'ë¶„'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> minutes </span><span class="token operator">=</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">publishTimeStr</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">(\d+)ë¶„</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    days </span><span class="token operator">=</span><span class=""> minutes </span><span class="token operator">/</span><span class=""></span><span class="token punctuation">(</span><span class="token number">24</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> days</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">extractRelatedKeywords</span><span class="token punctuation">(</span><span class="token parameter">page</span><span class="token parameter punctuation">,</span><span class="token parameter"> originalKeyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ê²€ìƒ‰ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">goto</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://www.youtube.com/results?search_query=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation function">encodeURIComponent</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation">originalKeyword</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">waitForSelector</span><span class="token punctuation">(</span><span class="token string">'#related-chip-bar, ytd-horizontal-card-list-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ê´€ë ¨ í‚¤ì›Œë“œ ì¶”ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> page</span><span class="token punctuation">.</span><span class="token method function property-access">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> chipItems </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'#related-chip-bar ytd-feed-chip-bar-renderer yt-chip-cloud-chip-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> keywords </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class="">      chipItems</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> text </span><span class="token operator">=</span><span class=""> item</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#text'</span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="">textContent</span><span class="token operator">?.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">text</span><span class="token punctuation">)</span><span class=""> keywords</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="">text</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> keywords</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">e</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ê´€ë ¨ í‚¤ì›Œë“œ ì¶”ì¶œ ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> e</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì„œë²„ ì‹œì‘</span><span class="">
</span></span><span class=""><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤ê°€ í¬íŠ¸ </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation constant">PORT</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></div></div></div></pre>

## 3. NextJS API ë¼ìš°íŠ¸ êµ¬í˜„

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// pages/api/youtube/search/[keyword].ts</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token keyword">type</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token maybe-class-name">NextApiRequest</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">NextApiResponse</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> connectToDatabase </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/lib/mongodb'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">ObjectId</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'mongodb'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">handler</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class="">  req</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextApiRequest</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">  res</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextApiResponse</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">req</span><span class="token punctuation">.</span><span class="token property-access">method</span><span class=""></span><span class="token operator">!==</span><span class=""></span><span class="token string">'GET'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">405</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">'error'</span><span class="token punctuation">,</span><span class=""> message</span><span class="token operator">:</span><span class=""></span><span class="token string">'í—ˆìš©ë˜ì§€ ì•ŠëŠ” ë©”ì†Œë“œ'</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">query</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> uid </span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">[</span><span class="token string">'x-user-id'</span><span class="token punctuation">]</span><span class=""></span><span class="token keyword module">as</span><span class=""></span><span class="token builtin">string</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">'anonymous'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> db </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">connectToDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì´ë¯¸ ê²€ìƒ‰ëœ í‚¤ì›Œë“œì¸ì§€ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> existingKeyword </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">        keyword</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">        uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì™„ë£Œëœ ê²€ìƒ‰ë§Œ</span><span class="">
</span></span><span class=""><span class="">        use_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"Y"</span><span class=""></span><span class="token comment">// í™œì„± ìƒíƒœì¸ ê²€ìƒ‰ë§Œ </span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        sort</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> update_dt</span><span class="token operator">:</span><span class=""></span><span class="token operator">-</span><span class="token number">1</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token comment">// ê°€ì¥ ìµœê·¼ ê²€ìƒ‰ ê²°ê³¼</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">existingKeyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ìºì‹œëœ ë°ì´í„° ë°˜í™˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'videos'</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">          keyword</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">          round_no</span><span class="token operator">:</span><span class=""> existingKeyword</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class="">          uid 
</span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">          videos</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          history</span><span class="token operator">:</span><span class=""> existingKeyword
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì§„í–‰ ì¤‘ì¸ ê²€ìƒ‰ì´ ìˆëŠ”ì§€ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> pendingKeyword </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">        keyword</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">        uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì²˜ë¦¬ ì¤‘</span><span class="">
</span></span><span class=""><span class="">        use_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"Y"</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">pendingKeyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì¸ ê²½ìš°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">          history</span><span class="token operator">:</span><span class=""> pendingKeyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          message</span><span class="token operator">:</span><span class=""></span><span class="token string">'ìš”ì²­ì´ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.'</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ìƒˆ ê²€ìƒ‰ ìš”ì²­ ìƒì„±</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> round_no </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> newKeyword </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      _id</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name maybe-class-name">ObjectId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      newKeyword</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      country</span><span class="token operator">:</span><span class=""></span><span class="token string">"KR"</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">      lang</span><span class="token operator">:</span><span class=""></span><span class="token string">"ko"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì²˜ë¦¬ ì¤‘</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      use_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"Y"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      scheduler_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"N"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      video_tp</span><span class="token operator">:</span><span class=""></span><span class="token string">"02"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      level</span><span class="token operator">:</span><span class=""></span><span class="token number">1</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      create_user</span><span class="token operator">:</span><span class=""> uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      create_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      update_user</span><span class="token operator">:</span><span class=""> uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">insertOne</span><span class="token punctuation">(</span><span class="">newKeyword</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// MongoDB Atlas íŠ¸ë¦¬ê±°ê°€ ë‚˜ë¨¸ì§€ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">        history</span><span class="token operator">:</span><span class=""> newKeyword
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'API ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">'error'</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">      message</span><span class="token operator">:</span><span class=""></span><span class="token string">'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

## 4. ì§„í–‰ ìƒíƒœ í´ë§ API ë¼ìš°íŠ¸

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// pages/api/youtube/status/[round_no].ts</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token keyword">type</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token maybe-class-name">NextApiRequest</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">NextApiResponse</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> connectToDatabase </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/lib/mongodb'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">handler</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class="">  req</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextApiRequest</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">  res</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextApiResponse</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">req</span><span class="token punctuation">.</span><span class="token property-access">method</span><span class=""></span><span class="token operator">!==</span><span class=""></span><span class="token string">'GET'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">405</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">'error'</span><span class="token punctuation">,</span><span class=""> message</span><span class="token operator">:</span><span class=""></span><span class="token string">'í—ˆìš©ë˜ì§€ ì•ŠëŠ” ë©”ì†Œë“œ'</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> round_no </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">query</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> uid </span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">[</span><span class="token string">'x-user-id'</span><span class="token punctuation">]</span><span class=""></span><span class="token keyword module">as</span><span class=""></span><span class="token builtin">string</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">'anonymous'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> db </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">connectToDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> keywordHistory </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> round_no</span><span class="token punctuation">,</span><span class=""> uid </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">keywordHistory</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">'error'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        message</span><span class="token operator">:</span><span class=""></span><span class="token string">'ìš”ì²­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ìƒíƒœê°€ ì™„ë£Œëœ ê²½ìš° ë¹„ë””ì˜¤ ë°ì´í„° í•¨ê»˜ ë°˜í™˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">keywordHistory</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'videos'</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> round_no</span><span class="token punctuation">,</span><span class=""> uid </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">          videos</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          history</span><span class="token operator">:</span><span class=""> keywordHistory</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          complete</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì²˜ë¦¬ ì¤‘ ë˜ëŠ” ì˜¤ë¥˜ ìƒíƒœ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">        history</span><span class="token operator">:</span><span class=""> keywordHistory</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        complete</span><span class="token operator">:</span><span class=""></span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        error</span><span class="token operator">:</span><span class=""> keywordHistory</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">"2"</span><span class=""></span><span class="token operator">?</span><span class=""> keywordHistory</span><span class="token punctuation">.</span><span class="token property-access">error_message</span><span class=""></span><span class="token operator">:</span><span class=""></span><span class="token keyword null nil">null</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'API ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">'error'</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">      message</span><span class="token operator">:</span><span class=""></span><span class="token string">'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

# ì‚¬ìš©ì ê²½í—˜ ê°œì„ ì„ ìœ„í•œ í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„

ì´ì œ ì‚¬ìš©ì ê²½í—˜ì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆëŠ” í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ë°©ë²•ì„ ì œì‹œí•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## 1. ë°˜ì‘í˜• ê²€ìƒ‰ í˜ì´ì§€ êµ¬í˜„ (React + TailwindCSS)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// pages/search.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useState</span><span class="token imports punctuation">,</span><span class="token imports"> useEffect </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useRouter </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next/router'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports">axios</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'axios'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">SearchBar</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/SearchBar'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">VideoGrid</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/VideoGrid'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">KeywordChips</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/KeywordChips'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">LoadingState</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/LoadingState'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">ErrorState</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/ErrorState'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">SearchPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> router </span><span class="token operator">=</span><span class=""></span><span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> router</span><span class="token punctuation">.</span><span class="token property-access">query</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">loading</span><span class="token punctuation">,</span><span class=""> setLoading</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">polling</span><span class="token punctuation">,</span><span class=""> setPolling</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">error</span><span class="token punctuation">,</span><span class=""> setError</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">roundNo</span><span class="token punctuation">,</span><span class=""> setRoundNo</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">videos</span><span class="token punctuation">,</span><span class=""> setVideos</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">relatedKeywords</span><span class="token punctuation">,</span><span class=""> setRelatedKeywords</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í‚¤ì›Œë“œë¡œ ê²€ìƒ‰ ì‹¤í–‰</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">keyword</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">fetchData</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> axios</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/api/youtube/search/</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation function">encodeURIComponent</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation">keyword </span><span class="token template-string interpolation keyword module">as</span><span class="token template-string interpolation"></span><span class="token template-string interpolation builtin">string</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> history </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setRoundNo</span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">        
</span><span class=""><span class=""></span><span class="token comment">// ì™„ë£Œëœ ê²€ìƒ‰ì¸ ê²½ìš°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'1'</span><span class=""></span><span class="token operator">&&</span><span class=""> response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">videos</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setVideos</span><span class="token punctuation">(</span><span class="">response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">videos</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setRelatedKeywords</span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">recKeywords</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setPolling</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì²˜ë¦¬ ì¤‘ì¸ ê²½ìš° í´ë§ ì‹œì‘</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setPolling</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">err</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> err</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">finally</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">[</span><span class="">keyword</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í´ë§ìœ¼ë¡œ ì²˜ë¦¬ ìƒíƒœ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">polling </span><span class="token operator">||</span><span class=""></span><span class="token operator">!</span><span class="">roundNo</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> pollInterval </span><span class="token operator">=</span><span class=""></span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> axios</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/api/youtube/status/</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">roundNo</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">      
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> history</span><span class="token punctuation">,</span><span class=""> videos</span><span class="token operator">:</span><span class=""> resultVideos</span><span class="token punctuation">,</span><span class=""> complete</span><span class="token punctuation">,</span><span class=""> error</span><span class="token operator">:</span><span class=""> resultError </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">        
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">complete</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì²˜ë¦¬ ì™„ë£Œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setVideos</span><span class="token punctuation">(</span><span class="">resultVideos </span><span class="token operator">||</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setRelatedKeywords</span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">recKeywords</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setPolling</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="">pollInterval</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'2'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì²˜ë¦¬ ì‹¤íŒ¨</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setError</span><span class="token punctuation">(</span><span class="">resultError </span><span class="token operator">||</span><span class=""></span><span class="token string">'ê²€ìƒ‰ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setPolling</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="">pollInterval</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">err</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ìƒíƒœ í™•ì¸ ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> err</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""></span><span class="token comment">// 3ì´ˆë§ˆë‹¤ í™•ì¸</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="">pollInterval</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">[</span><span class="">polling</span><span class="token punctuation">,</span><span class=""> roundNo</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ê´€ë ¨ í‚¤ì›Œë“œ í´ë¦­ ì²˜ë¦¬</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">handleKeywordClick</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">keyword</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    router</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/search?keyword=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation function">encodeURIComponent</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">container mx-auto px-4 py-8</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">SearchBar</span><span class="token tag"></span><span class="token tag attr-name">initialKeyword</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">keyword </span><span class="token tag script language-javascript keyword module">as</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript builtin">string</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">loading </span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">LoadingState</span><span class="token tag"></span><span class="token tag attr-name">message</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">ê²€ìƒ‰ ì¤‘ì…ë‹ˆë‹¤...</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token operator">:</span><span class=""> error </span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">ErrorState</span><span class="token tag"></span><span class="token tag attr-name">message</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">error</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token operator">:</span><span class=""> polling </span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">LoadingState</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">message</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">YouTube ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">progress</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript boolean">true</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">description</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">ì´ ê³¼ì •ì€ ì•½ 30ì´ˆì—ì„œ 1ë¶„ ì •ë„ ì†Œìš”ë©ë‹ˆë‹¤</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token operator">:</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mb-8</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h1</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-2xl font-bold mb-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">              "{keyword}" ê²€ìƒ‰ ê²°ê³¼
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">h1</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">relatedKeywords</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token operator">></span><span class=""></span><span class="token number">0</span><span class=""></span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">KeywordChips</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">keywords</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">relatedKeywords</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onKeywordClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">handleKeywordClick</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">VideoGrid</span><span class="token tag"></span><span class="token tag attr-name">videos</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">videos</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

## 2. ìŠ¤ì¼ˆë ˆ

Retry

Claude hit the max length for a message and has paused its response. You can write Continue to keep the chat going.

route

ts

route

ts

S

í˜„ì¬ ë¼ìš°íŠ¸ì— ìˆëŠ” tsíŒŒì¼ë“¤ ë¨¼ì €ì½ì–´ë´ì•¼ ë„ˆê°€ ë‚´ í˜„ì¬ ì½”ë“œì—ì„œ ê°œì„ ì´ ëœ ë²„ì „ìœ¼ë¡œ ë°˜í™˜í•´ì¤„ê±°ê°™ì•„

Edit

ë„¤, ì œê³µí•´ì£¼ì‹  ë‘ ê°œì˜ route.ts íŒŒì¼ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ íŒŒì¼ë“¤ì€ NextJS API ë¼ìš°íŠ¸ë¡œ, YouTube ë¶„ì„ ì„œë¹„ìŠ¤ì˜ ë°±ì—”ë“œ ë¡œì§ì„ ì²˜ë¦¬í•˜ê³  ìˆêµ°ìš”.

ì²« ë²ˆì§¸ íŒŒì¼ì€ `/api/v2/contents/videos` ë¼ìš°íŠ¸ë¡œ ë³´ì´ë©°, GET ìš”ì²­ì„ ì²˜ë¦¬í•˜ì—¬ íŠ¹ì • round_noì— í•´ë‹¹í•˜ëŠ” ë¹„ë””ì˜¤ ì •ë³´ì™€ í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

ë‘ ë²ˆì§¸ íŒŒì¼ì€ `/api/v2/contents/videos/request/keyword` ë¼ìš°íŠ¸ë¡œ ë³´ì´ë©°, POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ì—¬ ìƒˆë¡œìš´ í‚¤ì›Œë“œ ê²€ìƒ‰ ìš”ì²­ì„ ìƒì„±í•©ë‹ˆë‹¤.

ì´ì œ ì´ ì½”ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ MongoDB Atlasì˜ íŠ¸ë¦¬ê±°ë¥¼ í™œìš©í•œ ë¸Œë¼ìš°ì € ìŠ¤í¬ë˜í•‘ ì†”ë£¨ì…˜ì„ ì œì•ˆí•˜ê² ìŠµë‹ˆë‹¤. ê¸°ì¡´ ì½”ë“œì˜ êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ ê°œì„ ëœ ë²„ì „ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.

## ê°œì„ ëœ í‚¤ì›Œë“œ ìš”ì²­ ë¼ìš°íŠ¸ (POST)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// app/api/v2/contents/videos/request/keyword/route.ts</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">NextRequest</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">NextResponse</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"next/server"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> getServerSession </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"next-auth/next"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> connectToDatabase </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"@/lib/db"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">KeywordHistory</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">User</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">MembershipLimit</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"@/models"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> authOptions </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"@/app/api/auth/[...nextauth]/route"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> triggerYouTubeScraping </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"@/lib/atlas-triggers"</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token constant">POST</span><span class="token punctuation">(</span><span class="">req</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextRequest</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> session </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">getServerSession</span><span class="token punctuation">(</span><span class="">authOptions</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">session </span><span class="token operator">||</span><span class=""></span><span class="token operator">!</span><span class="">session</span><span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"ì¸ì¦ë˜ì§€ ì•Šì€ ìš”ì²­ì…ë‹ˆë‹¤."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">401</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> req</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">keyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">400</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">connectToDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> user </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> uid</span><span class="token operator">:</span><span class=""> session</span><span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">user</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">404</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì¸ í‚¤ì›Œë“œì¸ì§€ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> pendingKeyword </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      use_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"Y"</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">pendingKeyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          status</span><span class="token operator">:</span><span class=""></span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">            history</span><span class="token operator">:</span><span class=""> pendingKeyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            message</span><span class="token operator">:</span><span class=""></span><span class="token string">"ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì¸ í‚¤ì›Œë“œì…ë‹ˆë‹¤."</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì´ë¯¸ ì™„ë£Œëœ ìµœì‹  í‚¤ì›Œë“œì¸ì§€ í™•ì¸ (7ì¼ ì´ë‚´)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> recentKeyword </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      use_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"Y"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      update_dt</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> $gte</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">-</span><span class=""></span><span class="token number">7</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">24</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">60</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">60</span><span class=""></span><span class="token operator">*</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> update_dt</span><span class="token operator">:</span><span class=""></span><span class="token operator">-</span><span class="token number">1</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">recentKeyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          status</span><span class="token operator">:</span><span class=""></span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">            history</span><span class="token operator">:</span><span class=""> recentKeyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            message</span><span class="token operator">:</span><span class=""></span><span class="token string">"ìµœê·¼ ê²€ìƒ‰ëœ í‚¤ì›Œë“œì…ë‹ˆë‹¤."</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ë©¤ë²„ì‹­ ì œí•œ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> membershipLimit </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">MembershipLimit</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      membership_level</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">membership_level</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">"free"</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">membershipLimit</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> todayStart </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">      todayStart</span><span class="token punctuation">.</span><span class="token method function property-access">setHours</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class=""></span><span class="token number">0</span><span class="token punctuation">,</span><span class=""></span><span class="token number">0</span><span class="token punctuation">,</span><span class=""></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì˜¤ëŠ˜ ì‚¬ìš©í•œ ê²€ìƒ‰ íšŸìˆ˜ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> todaySearchCount </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">countDocuments</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        uid</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        create_dt</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> $gte</span><span class="token operator">:</span><span class=""> todayStart </span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">todaySearchCount </span><span class="token operator">>=</span><span class=""> membershipLimit</span><span class="token punctuation">.</span><span class="token property-access">daily_search_limit</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">            error</span><span class="token operator">:</span><span class=""></span><span class="token string">"ì¼ì¼ ê²€ìƒ‰ ì œí•œì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ë©¤ë²„ì‹­ ì—…ê·¸ë ˆì´ë“œë¥¼ ê³ ë ¤í•´ë³´ì„¸ìš”."</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">403</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ë¼ìš´ë“œ ë²ˆí˜¸ ìƒì„±</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> lastKeywordHistory </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> uid</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> round_no</span><span class="token operator">:</span><span class=""></span><span class="token operator">-</span><span class="token number">1</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">limit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> round_no </span><span class="token operator">=</span><span class=""> lastKeywordHistory 
</span></span><span class=""><span class=""></span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">lastKeywordHistory</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ ìƒì„±</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> newKeywordHistory </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      newKeyword</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      country</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">country</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">"KR"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      lang</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">lang</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">"ko"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      recKeywords</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      deletedKeywords</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class=""></span><span class="token comment">// ì²˜ë¦¬ ì¤‘</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      use_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"Y"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      scheduler_yn</span><span class="token operator">:</span><span class=""></span><span class="token string">"N"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      video_tp</span><span class="token operator">:</span><span class=""></span><span class="token string">"02"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      level</span><span class="token operator">:</span><span class=""></span><span class="token number">1</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      create_user</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      create_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      update_user</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      update_dt</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì‚¬ìš©ìì˜ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš© íšŸìˆ˜ ì¦ê°€</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOneAndUpdate</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> uid</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> $inc</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> algorithm_use_count</span><span class="token operator">:</span><span class=""></span><span class="token number">1</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// MongoDB Atlas íŠ¸ë¦¬ê±° ì‹¤í–‰ (ë˜ëŠ” ë³„ë„ ì²˜ë¦¬ ì„œë¹„ìŠ¤ í˜¸ì¶œ)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì´ ë¶€ë¶„ì€ Atlas íŠ¸ë¦¬ê±°ê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ê±°ë‚˜, ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">triggerYouTubeScraping</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        keywordId</span><span class="token operator">:</span><span class=""> newKeywordHistory</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        uid</span><span class="token operator">:</span><span class=""> user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">triggerError</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"ìŠ¤í¬ë˜í•‘ íŠ¸ë¦¬ê±° ì˜¤ë¥˜:"</span><span class="token punctuation">,</span><span class=""> triggerError</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ì‚¬ìš©ìì—ê²ŒëŠ” ì •ìƒ ì‘ë‹µ (ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¬ì‹œë„)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          history</span><span class="token operator">:</span><span class=""> newKeywordHistory</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token operator">:</span><span class=""></span><span class="token builtin">any</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"í‚¤ì›Œë“œ ê²€ìƒ‰ ì˜¤ë¥˜:"</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"í‚¤ì›Œë“œ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">500</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

## ê°œì„ ëœ ë¹„ë””ì˜¤ ì¡°íšŒ ë¼ìš°íŠ¸ (GET)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// app/api/v2/contents/videos/route.ts</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">NextRequest</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">NextResponse</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"next/server"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> getServerSession </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"next-auth/next"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> connectToDatabase </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"@/lib/db"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">KeywordHistory</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Video</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"@/models"</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> authOptions </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">"@/app/api/auth/[...nextauth]/route"</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token constant">GET</span><span class="token punctuation">(</span><span class="">req</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">NextRequest</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> session </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">getServerSession</span><span class="token punctuation">(</span><span class="">authOptions</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">session </span><span class="token operator">||</span><span class=""></span><span class="token operator">!</span><span class="">session</span><span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"ì¸ì¦ë˜ì§€ ì•Šì€ ìš”ì²­ì…ë‹ˆë‹¤."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">401</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> url </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name constant">URL</span><span class="token punctuation">(</span><span class="">req</span><span class="token punctuation">.</span><span class="token property-access">url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> round_no </span><span class="token operator">=</span><span class=""> url</span><span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"round_no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">round_no</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"round_no íŒŒë¼ë¯¸í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">400</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">connectToDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// í•´ë‹¹ ë¼ìš´ë“œì˜ í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> history </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token operator">:</span><span class=""> session</span><span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">select</span><span class="token punctuation">(</span><span class="token string">"keyword round_no status level _id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">history</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"í•´ë‹¹ ë¼ìš´ë“œì˜ í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">404</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ìƒíƒœê°€ "0"(ì²˜ë¦¬ ì¤‘)ì¸ ê²½ìš° ë¹ˆ ë¹„ë””ì˜¤ ë°°ì—´ ë°˜í™˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          status</span><span class="token operator">:</span><span class=""></span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">            videos</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            history</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            filter</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            processingStatus</span><span class="token operator">:</span><span class=""></span><span class="token string">"pending"</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ìƒíƒœê°€ "2"(ì˜¤ë¥˜)ì¸ ê²½ìš° ì—ëŸ¬ ì •ë³´ ë°˜í™˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">"2"</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          status</span><span class="token operator">:</span><span class=""></span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">            videos</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            history</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            filter</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            processingStatus</span><span class="token operator">:</span><span class=""></span><span class="token string">"error"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">            errorMessage</span><span class="token operator">:</span><span class=""></span><span class="token string">"ë°ì´í„° ìˆ˜ì§‘ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// í•„í„° íŒŒë¼ë¯¸í„° ì²˜ë¦¬</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> hookIndex </span><span class="token operator">=</span><span class=""> url</span><span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"hookIndex"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> growthIndex </span><span class="token operator">=</span><span class=""> url</span><span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"growthIndex"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> minViews </span><span class="token operator">=</span><span class=""> url</span><span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"minViews"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> maxViews </span><span class="token operator">=</span><span class=""> url</span><span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"maxViews"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> query</span><span class="token operator">:</span><span class=""></span><span class="token builtin">any</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token operator">:</span><span class=""> session</span><span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í•„í„° ì ìš©</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">hookIndex</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      query</span><span class="token punctuation">.</span><span class="token property-access">hookIndex</span><span class=""></span><span class="token operator">=</span><span class=""> hookIndex</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">growthIndex</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      query</span><span class="token punctuation">.</span><span class="token property-access">growthIndex</span><span class=""></span><span class="token operator">=</span><span class=""> growthIndex</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">minViews</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      query</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class=""> $gte</span><span class="token operator">:</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">minViews</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">maxViews</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">query</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        query</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class="token punctuation">.</span><span class="token property-access">$lte</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">maxViews</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        query</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class=""> $lte</span><span class="token operator">:</span><span class=""></span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">maxViews</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// í•´ë‹¹ ë¼ìš´ë“œì˜ ë¹„ë””ì˜¤ ëª©ë¡ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">Video</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="">query</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> viewCount</span><span class="token operator">:</span><span class=""></span><span class="token operator">-</span><span class="token number">1</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì ìš©ëœ í•„í„° ì •ë³´</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> filter </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      hookIndex</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      growthIndex</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      minViews</span><span class="token punctuation">,</span><span class="">
</span></span><span class="">      maxViews
</span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        status</span><span class="token operator">:</span><span class=""></span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          videos</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          history</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          filter</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          processingStatus</span><span class="token operator">:</span><span class=""></span><span class="token string">"completed"</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token operator">:</span><span class=""></span><span class="token builtin">any</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"ë¹„ë””ì˜¤ ì¡°íšŒ ì˜¤ë¥˜:"</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token maybe-class-name">NextResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> error</span><span class="token operator">:</span><span class=""></span><span class="token string">"ë¹„ë””ì˜¤ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">500</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

## Atlas íŠ¸ë¦¬ê±° í˜¸ì¶œ ìœ í‹¸ë¦¬í‹°

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// lib/atlas-triggers.ts</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports">axios</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'axios'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">interface</span><span class=""></span><span class="token class-name maybe-class-name">ScrapingTriggerParams</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">  keywordId</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  keyword</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  round_no</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  uid</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token doc-comment comment">/**
</span></span><span class=""> * YouTube í¬ë¡¤ë§ íŠ¸ë¦¬ê±° í•¨ìˆ˜
</span><span class=""> * Atlas íŠ¸ë¦¬ê±°ê°€ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ê²½ìš° ìˆ˜ë™ìœ¼ë¡œ í˜¸ì¶œ
</span><span class=""><span class="token doc-comment comment"> */</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">triggerYouTubeScraping</span><span class="token punctuation">(</span><span class="">params</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">ScrapingTriggerParams</span><span class="token punctuation">)</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">Promise</span><span class="token operator"><</span><span class="token keyword">void</span><span class="token operator">></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// í™˜ê²½ ë³€ìˆ˜ì—ì„œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token constant">SCRAPING_SERVICE_URL</span><span class=""></span><span class="token operator">=</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">SCRAPING_SERVICE_URL</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token constant">SCRAPING_SERVICE_API_KEY</span><span class=""></span><span class="token operator">=</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">SCRAPING_SERVICE_API_KEY</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">SCRAPING_SERVICE_URL</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">warn</span><span class="token punctuation">(</span><span class="token string">"SCRAPING_SERVICE_URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. Atlas íŠ¸ë¦¬ê±°ì— ì˜ì¡´í•©ë‹ˆë‹¤."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤ í˜¸ì¶œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> axios</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token constant">SCRAPING_SERVICE_URL</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        task</span><span class="token operator">:</span><span class=""></span><span class="token string">"youtube_search"</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        params</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          keywordId</span><span class="token operator">:</span><span class=""> params</span><span class="token punctuation">.</span><span class="token property-access">keywordId</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          keyword</span><span class="token operator">:</span><span class=""> params</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          round_no</span><span class="token operator">:</span><span class=""> params</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          uid</span><span class="token operator">:</span><span class=""> params</span><span class="token punctuation">.</span><span class="token property-access">uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">          maxResults</span><span class="token operator">:</span><span class=""></span><span class="token number">20</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        headers</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string-property property">'Content-Type'</span><span class="token operator">:</span><span class=""></span><span class="token string">'application/json'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string-property property">'Authorization'</span><span class="token operator">:</span><span class=""></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">Bearer </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation constant">SCRAPING_SERVICE_API_KEY</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">response</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">!==</span><span class=""></span><span class="token number">202</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">throw</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Error</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤ ì‘ë‹µ ì˜¤ë¥˜: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">response</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">status</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">ìŠ¤í¬ë˜í•‘ ì‘ì—… ìš”ì²­ ì„±ê³µ: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">params</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">keyword</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> (Round: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">params</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">round_no</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">)</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ìŠ¤í¬ë˜í•‘ íŠ¸ë¦¬ê±° ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">throw</span><span class=""> error</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

## í”„ë¡ íŠ¸ì—”ë“œ ê°œì„ : ì‚¬ìš©ì ê²½í—˜ ê·¹ëŒ€í™”ë¥¼ ìœ„í•œ êµ¬í˜„

ì´ì œ ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í•˜ê¸° ìœ„í•œ í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ì„ ì œì•ˆí•˜ê² ìŠµë‹ˆë‹¤. ì´ëŠ” ì „í˜•ì ì¸ ì„±ê³µ ì‚¬ë¡€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.

### 1. ê²€ìƒ‰ ì»´í¬ë„ŒíŠ¸ (React + Next.js)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/KeywordSearch.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string">'use client'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useState</span><span class="token imports punctuation">,</span><span class="token imports"> useEffect </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useRouter </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next/navigation'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports">axios</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'axios'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> toast </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react-hot-toast'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">Search</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Loader2</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">ArrowRight</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'lucide-react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">SkeletonLoader</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'./SkeletonLoader'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">VideoCard</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'./VideoCard'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">RelatedKeywordChips</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'./RelatedKeywordChips'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">KeywordSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> router </span><span class="token operator">=</span><span class=""></span><span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">keyword</span><span class="token punctuation">,</span><span class=""> setKeyword</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">isSearching</span><span class="token punctuation">,</span><span class=""> setIsSearching</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">isPolling</span><span class="token punctuation">,</span><span class=""> setIsPolling</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">roundNo</span><span class="token punctuation">,</span><span class=""> setRoundNo</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">progress</span><span class="token punctuation">,</span><span class=""> setProgress</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">videos</span><span class="token punctuation">,</span><span class=""> setVideos</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">history</span><span class="token punctuation">,</span><span class=""> setHistory</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">relatedKeywords</span><span class="token punctuation">,</span><span class=""> setRelatedKeywords</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// í´ë§ í•¨ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">pollResults</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">roundNo</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> axios</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/api/v2/contents/videos?round_no=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">roundNo</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> data </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">processingStatus</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'completed'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setVideos</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">videos</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setHistory</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">history</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setRelatedKeywords</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">history</span><span class="token punctuation">.</span><span class="token property-access">recKeywords</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setIsPolling</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">        toast</span><span class="token punctuation">.</span><span class="token method function property-access">success</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ê²°ê³¼ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">processingStatus</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'error'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ë°œìƒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setIsPolling</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">        toast</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">errorMessage</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">'ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì§„í–‰ ì¤‘ì¸ ê²½ìš° í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">prev</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">min</span><span class="token punctuation">(</span><span class="">prev </span><span class="token operator">+</span><span class=""></span><span class="token number">10</span><span class="token punctuation">,</span><span class=""></span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'í´ë§ ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// í´ë§ ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ê³„ì† ì‹œë„</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// í´ë§ ì‹œì‘</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">isPolling</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> interval </span><span class="token operator">=</span><span class=""></span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="">pollResults</span><span class="token punctuation">,</span><span class=""></span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="">interval</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">[</span><span class="">isPolling</span><span class="token punctuation">,</span><span class=""> roundNo</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ê²€ìƒ‰ ì²˜ë¦¬</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">handleSearch</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="">e</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    e</span><span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">keyword</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token function">setIsSearching</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setVideos</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setRelatedKeywords</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// í‚¤ì›Œë“œ ê²€ìƒ‰ ìš”ì²­</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> axios</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/api/v2/contents/videos/request/keyword'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        keyword</span><span class="token operator">:</span><span class=""> keyword</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> data </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setRoundNo</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">history</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setHistory</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">history</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// ì´ë¯¸ ì²˜ë¦¬ëœ í‚¤ì›Œë“œì¸ ê²½ìš°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">history</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'1'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ë°ì´í„° ì¦‰ì‹œ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videosResponse </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> axios</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/api/v2/contents/videos?round_no=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">data</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">history</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">round_no</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setVideos</span><span class="token punctuation">(</span><span class="">videosResponse</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">videos</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setRelatedKeywords</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">history</span><span class="token punctuation">.</span><span class="token property-access">recKeywords</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">        toast</span><span class="token punctuation">.</span><span class="token method function property-access">success</span><span class="token punctuation">(</span><span class="token string">'ìºì‹œëœ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ë¹„ë™ê¸° ì²˜ë¦¬ ì‹œì‘</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setIsPolling</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">        toast</span><span class="token punctuation">.</span><span class="token method function property-access">loading</span><span class="token punctuation">(</span><span class="token string">'YouTube ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">          duration</span><span class="token operator">:</span><span class=""></span><span class="token number">5000</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token comment">// URL ì—…ë°ì´íŠ¸ (íˆìŠ¤í† ë¦¬ì— ê¸°ë¡)</span><span class="">
</span></span><span class=""><span class="">      router</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/search?keyword=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation function">encodeURIComponent</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation method function property-access">trim</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&round=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">data</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">history</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">round_no</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">      toast</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">finally</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setIsSearching</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ê´€ë ¨ í‚¤ì›Œë“œ í´ë¦­ ì²˜ë¦¬</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">handleRelatedKeywordClick</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">relatedKeyword</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setKeyword</span><span class="token punctuation">(</span><span class="">relatedKeyword</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ìë™ ê²€ìƒ‰ ì‹¤í–‰</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> form </span><span class="token operator">=</span><span class=""></span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'search-form'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">form</span><span class="token punctuation">)</span><span class=""> form</span><span class="token punctuation">.</span><span class="token method function property-access">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class=""></span><span class="token class-name maybe-class-name">Event</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""> cancelable</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full max-w-6xl mx-auto px-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">form</span><span class="token tag"></span><span class="token tag attr-name">id</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">search-form</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag attr-name">onSubmit</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">handleSearch</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mb-8</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center border-2 border-blue-500 rounded-lg overflow-hidden shadow-lg</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">input</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">value</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">keyword</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onChange</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">e</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setKeyword</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">e</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">target</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">value</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full px-5 py-4 text-lg focus:outline-none</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">placeholder</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">ë¶„ì„í•  YouTube í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">disabled</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">isSearching </span><span class="token tag script language-javascript operator">||</span><span class="token tag script language-javascript"> isPolling</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">submit</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">bg-blue-500 text-white px-6 py-4 h-full flex items-center </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation punctuation">(</span><span class="token tag script language-javascript template-string interpolation">isSearching </span><span class="token tag script language-javascript template-string interpolation operator">||</span><span class="token tag script language-javascript template-string interpolation"> isPolling</span><span class="token tag script language-javascript template-string interpolation punctuation">)</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'opacity-70 cursor-not-allowed'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'hover:bg-blue-600'</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">disabled</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">isSearching </span><span class="token tag script language-javascript operator">||</span><span class="token tag script language-javascript"> isPolling</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">isSearching </span><span class="token operator">||</span><span class=""> isPolling </span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">Loader2</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-6 h-6 animate-spin</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token operator">:</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">Search</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-6 h-6</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">ml-2 hidden sm:inline</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ë¶„ì„</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">form</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">isPolling </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mb-10 text-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full bg-gray-200 rounded-full h-2.5 mb-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">bg-blue-500 h-2.5 rounded-full transition-all duration-500</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">style</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript"> width</span><span class="token tag script language-javascript operator">:</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">progress</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string string">%</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">}</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-gray-600</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">YouTube ë°ì´í„°ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤. ì•½ 30ì´ˆê°€ ì†Œìš”ë©ë‹ˆë‹¤.</span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">relatedKeywords</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token operator">></span><span class=""></span><span class="token number">0</span><span class=""></span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mb-8</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h3</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-lg font-medium mb-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ê´€ë ¨ í‚¤ì›Œë“œ</span><span class="token tag punctuation"></</span><span class="token tag">h3</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">RelatedKeywordChips</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">keywords</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">relatedKeywords</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onKeywordClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">handleRelatedKeywordClick</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">isPolling </span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ìŠ¤ì¼ˆë ˆí†¤ ë¡œë” í‘œì‹œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token known-class-name class-name">Array</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">_</span><span class="token punctuation">,</span><span class=""> i</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">SkeletonLoader</span><span class="token tag"></span><span class="token tag attr-name">key</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">i</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token operator">:</span><span class=""> videos</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token operator">></span><span class=""></span><span class="token number">0</span><span class=""></span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ê²°ê³¼ í‘œì‹œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex justify-between items-center mb-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h2</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-2xl font-bold</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ë¶„ì„ ê²°ê³¼</span><span class="token tag punctuation"></</span><span class="token tag">h2</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">a</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">#detailed-analysis</span><span class="token tag attr-value punctuation">"</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-blue-500 hover:text-blue-700 flex items-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">              ìƒì„¸ ë¶„ì„ ë³´ê¸°
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">ArrowRight</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 ml-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">a</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">videos</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">VideoCard</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">key</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">videoId</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">video</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token operator">:</span><span class=""></span><span class="token operator">!</span><span class="">isSearching </span><span class="token operator">&&</span><span class=""></span><span class="token operator">!</span><span class="">isPolling </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì´ˆê¸° ìƒíƒœ ë˜ëŠ” ê²°ê³¼ ì—†ìŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-center py-10</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-gray-500</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">            í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰í•˜ì—¬ YouTube ì½˜í…ì¸ ë¥¼ ë¶„ì„í•´ë³´ì„¸ìš”.
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 2. ë¹„ë””ì˜¤ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/VideoCard.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useState </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">Image</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next/image'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> formatDistanceToNow </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'date-fns'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> ko </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'date-fns/locale'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">Eye</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Users</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Clock</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">ThumbsUp</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Award</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">TrendingUp</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'lucide-react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">interface</span><span class=""></span><span class="token class-name maybe-class-name">VideoCardProps</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">  video</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    videoId</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    title</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    thumbnail</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    channelTitle</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    viewCount</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    subscriberCount</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    publishDate</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    duration</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    hookIndex</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    growthIndex</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    exposureProbability</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> formatNumber </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">num</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">>=</span><span class=""></span><span class="token number">10000000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">/</span><span class=""></span><span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token string">'ì²œë§Œ'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">>=</span><span class=""></span><span class="token number">10000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">/</span><span class=""></span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token string">'ë§Œ'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">>=</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">/</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token string">'ì²œ'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> num</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> getIndexColor </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">index</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">switch</span><span class=""></span><span class="token punctuation">(</span><span class="">index</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'A'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'bg-green-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'B'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'bg-blue-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'C'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'bg-yellow-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'D'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'bg-orange-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'F'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'bg-red-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">default</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'bg-gray-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">VideoCard</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> video </span><span class="token punctuation">}</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">VideoCardProps</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">isHovered</span><span class="token punctuation">,</span><span class=""> setIsHovered</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> publishDate </span><span class="token operator">=</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Date</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">publishDate</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> timeAgo </span><span class="token operator">=</span><span class=""></span><span class="token function">formatDistanceToNow</span><span class="token punctuation">(</span><span class="">publishDate</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""> addSuffix</span><span class="token operator">:</span><span class=""></span><span class="token boolean">true</span><span class="token punctuation">,</span><span class=""> locale</span><span class="token operator">:</span><span class=""> ko </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onMouseEnter</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setIsHovered</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript boolean">true</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onMouseLeave</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setIsHovered</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript boolean">false</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">relative</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Image</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">src</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">thumbnail</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">alt</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">title</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">width</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript number">640</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">height</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript number">360</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full h-44 object-cover</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">absolute bottom-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">duration</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">isHovered </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">a</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">href</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">https://www.youtube.com/watch?v=</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">video</span><span class="token tag script language-javascript template-string interpolation punctuation">.</span><span class="token tag script language-javascript template-string interpolation property-access">videoId</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">target</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">_blank</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">noopener noreferrer</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">absolute inset-0 flex items-center justify-center bg-black bg-opacity-50</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">bg-red-600 text-white rounded-full p-3</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">svg</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-10 h-10</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag attr-name">fill</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">currentColor</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag attr-name">viewBox</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">0 0 24 24</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">path</span><span class="token tag"></span><span class="token tag attr-name">d</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">M8 5v14l11-7z</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">svg</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">a</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">p-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h3</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-lg font-semibold mb-2 line-clamp-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">h3</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-gray-600 mb-3</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">channelTitle</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex flex-wrap gap-2 mb-3</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center text-sm text-gray-500</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Eye</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center text-sm text-gray-500</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Users</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">subscriberCount</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center text-sm text-gray-500</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Clock</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="">timeAgo</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">grid grid-cols-2 gap-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">border rounded p-2 text-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center justify-center mb-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Award</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-sm</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">í›„í‚¹ ì§€ìˆ˜</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">text-white font-bold rounded-full w-8 h-8 flex items-center justify-center mx-auto </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation function">getIndexColor</span><span class="token tag script language-javascript template-string interpolation punctuation">(</span><span class="token tag script language-javascript template-string interpolation">video</span><span class="token tag script language-javascript template-string interpolation punctuation">.</span><span class="token tag script language-javascript template-string interpolation property-access">hookIndex</span><span class="token tag script language-javascript template-string interpolation punctuation">)</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">hookIndex</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">border rounded p-2 text-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center justify-center mb-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">TrendingUp</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-sm</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ì„±ì¥ ì§€ìˆ˜</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">text-white font-bold rounded-full w-8 h-8 flex items-center justify-center mx-auto </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation function">getIndexColor</span><span class="token tag script language-javascript template-string interpolation punctuation">(</span><span class="token tag script language-javascript template-string interpolation">video</span><span class="token tag script language-javascript template-string interpolation punctuation">.</span><span class="token tag script language-javascript template-string interpolation property-access">growthIndex</span><span class="token tag script language-javascript template-string interpolation punctuation">)</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">growthIndex</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 3. ìŠ¤ì¼ˆë ˆí†¤ ë¡œë” ì»´í¬ë„ŒíŠ¸

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/SkeletonLoader.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">SkeletonLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">bg-white rounded-lg shadow-md overflow-hidden animate-pulse</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full h-44 bg-gray-300</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">p-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-5 bg-gray-300 rounded w-3/4 mb-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-5 bg-gray-300 rounded w-1/2 mb-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex gap-2 mb-3</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-4 bg-gray-300 rounded w-16</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-4 bg-gray-300 rounded w-20</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">grid grid-cols-2 gap-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">border rounded p-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-4 bg-gray-300 rounded w-3/4 mx-auto mb-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-8 w-8 bg-gray-300 rounded-full mx-auto</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">border rounded p-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-4 bg-gray-300 rounded w-3/4 mx-auto mb-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-8 w-8 bg-gray-300 rounded-full mx-auto</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 4. ê´€ë ¨ í‚¤ì›Œë“œ ì¹© ì»´í¬ë„ŒíŠ¸

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/RelatedKeywordChips.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">interface</span><span class=""></span><span class="token class-name maybe-class-name">RelatedKeywordCh</span></span></code></div></div></div></pre>

Retry

Claude hit the max length for a message and has paused its response. You can write Continue to keep the chat going.

S

ì´ì–´ì„œ ìƒì„±í•´.
next jsì™€ vercel ì„ ì´ìš©í•´ ë°°í¬í• ê±°ê³ ,
aië¶„ì„ ê²°ê³¼ ê°’ì„ ë°˜í™˜í• ê±´ë° uiì»´í¬ë„ŒíŠ¸ëŠ” ì½”ë“œ ì—ë””í„° ë‚´ì˜ ì½”íŒŒì¼ëŸ¿ì²˜ëŸ¼ ìš°ì¸¡ì— ì‚¬ì´ë“œë°”ì—ì„œ ê° íƒ­ì—ì„œ aiê°€ ì˜ìƒì— ëŒ€í•œ ë¶„ì„ì„ í•´ì£¼ëŠ” ê±°ì•¼. ê²€ìƒ‰ê²°ê³¼ëŠ” ë¼ì¸í˜•ìœ¼ë¡œ ì œëª©, ì¸ë„¤ì¼, í›„í‚¹ì§€ìˆ˜ ì„±ì¥ì§€ìˆ˜, êµ¬ë…ì ìˆ˜ ì˜ìƒí”Œë ˆì´ ì‹œê°„ ë“±ì´ê³  ìƒì„¸ ë¶„ì„ê¸°ëŠ¥ì´ ì˜ìƒì„ í´ë¦­í•˜ë©´ ì‚¬ì´ë“œë°”ê°€ ì¶”ê°€ë¡œ ì—´ë ¤ì„œ ìŠ¤í¬ë¦½íŠ¸ì¶”ì¶œê³¼ ì¬ì„¤ê³„ ì—­ì„¤ê³„ë“±ì„ í¬í•¨í•œ aië§ˆì¼€íŒ… ìë™í™” ì„œë¹„ìŠ¤ë¥¼ í•´ì£¼ëŠ” ê±´ë°, ë‚´ê°€ ì–´ë ¤ì›€ì„ ê²ªì—ˆë˜ ê²Œ ìœ ì¦ˆ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ìš”í•˜ë‹ˆê¹Œ ë³´ì•ˆì •ì±…ë•Œë¬¸ì¸ì§€ ë°ì´í„° êµí™˜ì´ ì›í™œí•˜ì§€ ì•Šì•„ ìê¾¸ ì—ëŸ¬ê°€ ëœ¨ë”ë¼ê³ . ê·¸ê±¸ ê³ ë ¤í•´ì¤˜ì„œ í”„ë¡ íŠ¸ì™€ ë°±ì—”ë“œë¥¼ ê°œì„ í•´ì¤˜

Edit

ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í•˜ë©´ì„œ NextJSì™€ Vercel í™˜ê²½ì— ìµœì í™”ëœ í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ë°ì´í„° êµí™˜ êµ¬ì¡°ë¡œ ê°œì„ í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤. íŠ¹íˆ useClient ì‚¬ìš© ì‹œ ë³´ì•ˆ ì •ì±… ê´€ë ¨ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ì•„í‚¤í…ì²˜ë¥¼ ì œì•ˆí•˜ê² ìŠµë‹ˆë‹¤.

# ê°œì„ ëœ YouTube ë¶„ì„ ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

## 1. í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ë°ì´í„° êµí™˜ ì•„í‚¤í…ì²˜

NextJSì˜ Server Componentsì™€ Client Componentsë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í™œìš©í•˜ì—¬ ë³´ì•ˆ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” êµ¬ì¡°ë¥¼ ì„¤ê³„í•˜ê² ìŠµë‹ˆë‹¤.

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code><span class=""><span class="">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class="">â”‚ Server Components   â”‚      â”‚ Client Componentsâ”‚
</span><span class="">â”‚                     â”‚      â”‚                  â”‚
</span><span class="">â”‚ - ë°ì´í„° íŒ¨ì¹­       â”‚      â”‚ - ì‚¬ìš©ì ìƒí˜¸ì‘ìš©â”‚
</span><span class="">â”‚ - ì¸ì¦ ì²˜ë¦¬         â”‚â—„â”€â”€â”€â”€â–ºâ”‚ - UI ì• ë‹ˆë©”ì´ì…˜  â”‚
</span><span class="">â”‚ - ì´ˆê¸° ë Œë”ë§       â”‚      â”‚ - ìƒíƒœ ê´€ë¦¬      â”‚
</span><span class="">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span><span class="">          â–²                            â”‚
</span><span class="">          â”‚                            â”‚
</span><span class="">          â”‚                            â–¼
</span><span class="">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span class="">â”‚ API Routes          â”‚      â”‚ Custom Hooks     â”‚
</span><span class="">â”‚                     â”‚      â”‚                  â”‚
</span><span class="">â”‚ - ë°ì´í„° CRUD       â”‚â—„â”€â”€â”€â”€â–ºâ”‚ - ë°ì´í„° ìºì‹±    â”‚
</span><span class="">â”‚ - ì™¸ë¶€ API í†µì‹      â”‚      â”‚ - SWR/React Queryâ”‚
</span><span class="">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></code></div></div></div></pre>

ì´ ì•„í‚¤í…ì²˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì´ì ì„ ì œê³µí•©ë‹ˆë‹¤:

1. Server Componentsì—ì„œ ë¯¼ê°í•œ ë°ì´í„° ì²˜ë¦¬
2. Client Componentsì—ì„œëŠ” UI ìƒí˜¸ì‘ìš©ì—ë§Œ ì§‘ì¤‘
3. API Routesë¥¼ í†µí•œ ë°ì´í„° í†µì‹ ìœ¼ë¡œ CORS ë° ë³´ì•ˆ ì •ì±… ë¬¸ì œ í•´ê²°
4. SWR/React Queryë¥¼ í™œìš©í•œ íš¨ìœ¨ì ì¸ ë°ì´í„° ìºì‹±

## 2. í•µì‹¬ íŒŒì¼ êµ¬ì¡°

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code><span class=""><span class="">app/
</span></span><span class="">â”œâ”€â”€ (auth)/
</span><span class="">â”‚   â””â”€â”€ login/
</span><span class="">â”‚       â””â”€â”€ page.tsx        # ë¡œê·¸ì¸ í˜ì´ì§€ (Server Component)
</span><span class="">â”œâ”€â”€ (dashboard)/
</span><span class="">â”‚   â”œâ”€â”€ search/
</span><span class="">â”‚   â”‚   â””â”€â”€ page.tsx        # ê²€ìƒ‰ í˜ì´ì§€ (Server Component)
</span><span class="">â”‚   â””â”€â”€ video/
</span><span class="">â”‚       â””â”€â”€ [videoId]/
</span><span class="">â”‚           â””â”€â”€ page.tsx    # ë¹„ë””ì˜¤ ìƒì„¸ í˜ì´ì§€ (Server Component)
</span><span class="">â”œâ”€â”€ api/
</span><span class="">â”‚   â”œâ”€â”€ auth/
</span><span class="">â”‚   â”‚   â””â”€â”€ [...nextauth]/
</span><span class="">â”‚   â”‚       â””â”€â”€ route.ts   # ì¸ì¦ API
</span><span class="">â”‚   â”œâ”€â”€ youtube/
</span><span class="">â”‚   â”‚   â”œâ”€â”€ analysis/
</span><span class="">â”‚   â”‚   â”‚   â””â”€â”€ route.ts   # AI ë¶„ì„ API
</span><span class="">â”‚   â”‚   â”œâ”€â”€ search/
</span><span class="">â”‚   â”‚   â”‚   â””â”€â”€ route.ts   # ê²€ìƒ‰ API
</span><span class="">â”‚   â”‚   â””â”€â”€ video/
</span><span class="">â”‚   â”‚       â””â”€â”€ [videoId]/
</span><span class="">â”‚   â”‚           â””â”€â”€ route.ts # ë¹„ë””ì˜¤ ìƒì„¸ API
</span><span class="">â”‚   â””â”€â”€ scraping/
</span><span class="">â”‚       â””â”€â”€ route.ts       # ìŠ¤í¬ë˜í•‘ ì²˜ë¦¬ API
</span><span class="">â”œâ”€â”€ components/
</span><span class="">â”‚   â”œâ”€â”€ client/           # Client Components
</span><span class="">â”‚   â”‚   â”œâ”€â”€ SearchBar.tsx
</span><span class="">â”‚   â”‚   â”œâ”€â”€ VideoList.tsx
</span><span class="">â”‚   â”‚   â”œâ”€â”€ VideoCard.tsx
</span><span class="">â”‚   â”‚   â”œâ”€â”€ AnalysisSidebar.tsx
</span><span class="">â”‚   â”‚   â””â”€â”€ ScriptGenerator.tsx
</span><span class="">â”‚   â””â”€â”€ server/           # Server Components
</span><span class="">â”‚       â”œâ”€â”€ VideoContent.tsx
</span><span class="">â”‚       â””â”€â”€ SearchResults.tsx
</span><span class="">â”œâ”€â”€ lib/
</span><span class="">â”‚   â”œâ”€â”€ db.ts             # MongoDB ì—°ê²°
</span><span class="">â”‚   â”œâ”€â”€ auth.ts           # ì¸ì¦ ìœ í‹¸ë¦¬í‹°
</span><span class="">â”‚   â”œâ”€â”€ api-handlers.ts   # API ìš”ì²­ í•¸ë“¤ëŸ¬
</span><span class="">â”‚   â””â”€â”€ youtube-scraper.ts # ìŠ¤í¬ë˜í•‘ ë¡œì§
</span><span class="">â””â”€â”€ hooks/
</span><span class="">    â”œâ”€â”€ useSearch.ts      # ê²€ìƒ‰ ê¸°ëŠ¥ Hook
</span><span class="">    â”œâ”€â”€ useAnalysis.ts    # AI ë¶„ì„ ê¸°ëŠ¥ Hook
</span><span class="">    â””â”€â”€ useVideoData.ts   # ë¹„ë””ì˜¤ ë°ì´í„° Hook</span></code></div></div></div></pre>

## 3. ê°œì„ ëœ ì½”ë“œ êµ¬í˜„

### 3.1 ì„œë²„ ì»´í¬ë„ŒíŠ¸ (ê²€ìƒ‰ í˜ì´ì§€)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// app/(dashboard)/search/page.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">Suspense</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">SearchBar</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/client/SearchBar'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">SearchResults</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/server/SearchResults'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> getServerSession </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next-auth/next'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> redirect </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next/navigation'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> authOptions </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/app/api/auth/[...nextauth]/route'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports maybe-class-name">LoadingSpinner</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/client/LoadingSpinner'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ê²€ìƒ‰ í˜ì´ì§€ì˜ ì„œë²„ ì»´í¬ë„ŒíŠ¸ (ì„œë²„ì—ì„œ ë Œë”ë§ë¨)</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">SearchPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class="">  searchParams 
</span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">  searchParams</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token operator">?</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class=""> round_no</span><span class="token operator">?</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class=""></span><span class="token punctuation">}</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì„œë²„ì—ì„œ ì¸ì¦ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> session </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">getServerSession</span><span class="token punctuation">(</span><span class="">authOptions</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">session </span><span class="token operator">||</span><span class=""></span><span class="token operator">!</span><span class="">session</span><span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì¸ì¦ë˜ì§€ ì•Šì€ ê²½ìš° ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token punctuation">,</span><span class=""> round_no </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> searchParams</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex flex-col min-h-screen</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">main</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex-grow</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">max-w-7xl mx-auto px-4 py-6</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ (ì‚¬ìš©ì ìƒí˜¸ì‘ìš©) */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">SearchBar</span><span class="token tag"></span><span class="token tag attr-name">initialKeyword</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">keyword </span><span class="token tag script language-javascript operator">||</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">''</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ì„œë²„ ì»´í¬ë„ŒíŠ¸ (ë°ì´í„° ë¡œë”©) */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Suspense</span><span class="token tag"></span><span class="token tag attr-name">fallback</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation"><</span><span class="token tag script language-javascript class-name">LoadingSpinner</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">/></span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">keyword </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">SearchResults</span><span class="token tag"></span><span class="token tag attr-name">keyword</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">keyword</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag attr-name">round_no</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">round_no</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag attr-name">uid</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">session</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">user</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">uid</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag class-name">Suspense</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">main</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 3.2 ì„œë²„ ì»´í¬ë„ŒíŠ¸ (ê²€ìƒ‰ ê²°ê³¼)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/server/SearchResults.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">VideoList</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/client/VideoList'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> connectToDatabase </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/lib/db'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">KeywordHistory</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Video</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/models'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">AnalysisProgress</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/components/client/AnalysisProgress'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ” 'use client'ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">SearchResults</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">  keyword</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class=""><span class="">  round_no</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class="">  uid 
</span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class=""><span class="">  keyword</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class=""> 
</span></span><span class=""><span class="">  round_no</span><span class="token operator">?</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class=""> 
</span></span><span class=""><span class="">  uid</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class=""> 
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì„œë²„ì—ì„œ ì§ì ‘ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">connectToDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ìµœì‹  ê²€ìƒ‰ íˆìŠ¤í† ë¦¬ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> history</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">round_no</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// íŠ¹ì • ë¼ìš´ë“œì˜ ê²€ìƒ‰ ê²°ê³¼ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class="">    history </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// í•´ë‹¹ í‚¤ì›Œë“œì˜ ìµœì‹  ê²€ìƒ‰ ê²°ê³¼ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class="">    history </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">KeywordHistory</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      keyword</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">      uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> create_dt</span><span class="token operator">:</span><span class=""></span><span class="token operator">-</span><span class="token number">1</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">history</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì´ì „ ê²€ìƒ‰ ê¸°ë¡ì´ ì—†ëŠ” ê²½ìš° - ì´ˆê¸° ìƒíƒœ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mt-8 text-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-gray-600</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">          í‚¤ì›Œë“œ "{keyword}"ì— ëŒ€í•œ ê²€ìƒ‰ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í”„ë¡œì„¸ì‹± ìƒíƒœ í™•ì¸</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì§„í–‰ ì¤‘ì¸ ê²€ìƒ‰</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mt-8</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">AnalysisProgress</span><span class="token tag"></span><span class="token tag attr-name">keyword</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">keyword</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag attr-name">roundNo</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">history</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">round_no</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">history</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">"2"</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// ì˜¤ë¥˜ ë°œìƒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mt-8 text-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">p-4 bg-red-50 text-red-700 rounded-lg</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">font-medium</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-sm mt-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”</span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ëª©ë¡ ì¡°íšŒ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> videos </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token maybe-class-name">Video</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    round_no</span><span class="token operator">:</span><span class=""> history</span><span class="token punctuation">.</span><span class="token property-access">round_no</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">    uid</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> viewCount</span><span class="token operator">:</span><span class=""></span><span class="token operator">-</span><span class="token number">1</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ê´€ë ¨ í‚¤ì›Œë“œ</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> relatedKeywords </span><span class="token operator">=</span><span class=""> history</span><span class="token punctuation">.</span><span class="token property-access">recKeywords</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì— props ì „ë‹¬</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mt-8</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">VideoList</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">videos</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript known-class-name class-name">JSON</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript method function property-access">parse</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript known-class-name class-name">JSON</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript method function property-access">stringify</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">videos</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">relatedKeywords</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">relatedKeywords</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">historyId</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">history</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">_id</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript method function property-access">toString</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">roundNo</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">history</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">round_no</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 3.3 í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ (ê²€ìƒ‰ ë°”)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/client/SearchBar.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string">'use client'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useState </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useRouter </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'next/navigation'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">Search</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Loader2</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'lucide-react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> toast </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react-hot-toast'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">SearchBar</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> initialKeyword </span><span class="token operator">=</span><span class=""></span><span class="token string">''</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> router </span><span class="token operator">=</span><span class=""></span><span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">keyword</span><span class="token punctuation">,</span><span class=""> setKeyword</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="">initialKeyword</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">isSearching</span><span class="token punctuation">,</span><span class=""> setIsSearching</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">handleSearch</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token punctuation">(</span><span class="">e</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">FormEvent</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    e</span><span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">keyword</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""></span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token function">setIsSearching</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// API Routeë¥¼ í†µí•œ ê²€ìƒ‰ ìš”ì²­</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> response </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/youtube/search'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        method</span><span class="token operator">:</span><span class=""></span><span class="token string">'POST'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        headers</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string-property property">'Content-Type'</span><span class="token operator">:</span><span class=""></span><span class="token string">'application/json'</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class="">        body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> keyword</span><span class="token operator">:</span><span class=""> keyword</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">response</span><span class="token punctuation">.</span><span class="token property-access">ok</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">throw</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name known-class-name">Error</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ìš”ì²­ ì‹¤íŒ¨'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> data </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> response</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">    
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">status</span><span class=""></span><span class="token operator">===</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token comment">// URL íŒŒë¼ë¯¸í„°ë¡œ ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™</span><span class="">
</span></span><span class=""><span class="">        router</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/search?keyword=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation function">encodeURIComponent</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&round_no=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">data</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">data</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">history</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">round_no</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">        toast</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">.</span><span class="token property-access">error</span><span class=""></span><span class="token operator">||</span><span class=""></span><span class="token string">'ê²€ìƒ‰ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ì˜¤ë¥˜:'</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">      toast</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">finally</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setIsSearching</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">form</span><span class="token tag"></span><span class="token tag attr-name">onSubmit</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">handleSearch</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center border-2 border-blue-500 rounded-lg overflow-hidden shadow-lg</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">input</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">value</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">keyword</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onChange</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">e</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setKeyword</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">e</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">target</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">value</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full px-5 py-4 text-lg focus:outline-none</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">placeholder</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">ë¶„ì„í•  YouTube í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">disabled</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">isSearching</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">submit</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">bg-blue-500 text-white px-6 py-4 h-full flex items-center </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation">            isSearching </span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'opacity-70 cursor-not-allowed'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'hover:bg-blue-600'</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">disabled</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">isSearching</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">isSearching </span><span class="token operator">?</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">Loader2</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-6 h-6 animate-spin</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class=""></span><span class="token operator">:</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">Search</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-6 h-6</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">ml-2 hidden sm:inline</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ë¶„ì„</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">form</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 3.4 í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ (ë¹„ë””ì˜¤ ëª©ë¡)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/client/VideoList.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string">'use client'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useEffect</span><span class="token imports punctuation">,</span><span class="token imports"> useState </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">VideoCard</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'./VideoCard'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">AnalysisSidebar</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'./AnalysisSidebar'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">VideoAnalysisStatus</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'./VideoAnalysisStatus'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">interface</span><span class=""></span><span class="token class-name maybe-class-name">Video</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">  _id</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  videoId</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  title</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  thumbnail</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  channelTitle</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  channelId</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  viewCount</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  subscriberCount</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  duration</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  publishDate</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  hookIndex</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  growthIndex</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  exposureProbability</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">interface</span><span class=""></span><span class="token class-name maybe-class-name">VideoListProps</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">  videos</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">Video</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  relatedKeywords</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  historyId</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  roundNo</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">VideoList</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> videos</span><span class="token punctuation">,</span><span class=""> relatedKeywords</span><span class="token punctuation">,</span><span class=""> historyId</span><span class="token punctuation">,</span><span class=""> roundNo </span><span class="token punctuation">}</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">VideoListProps</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">selectedVideo</span><span class="token punctuation">,</span><span class=""> setSelectedVideo</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token generic-function function">useState</span><span class="token generic-function generic class-name operator"><</span><span class="token generic-function generic class-name maybe-class-name">Video</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name operator">|</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name keyword null nil">null</span><span class="token generic-function generic class-name operator">></span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">isSidebarOpen</span><span class="token punctuation">,</span><span class=""> setIsSidebarOpen</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">sortBy</span><span class="token punctuation">,</span><span class=""> setSortBy</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token generic-function function">useState</span><span class="token generic-function generic class-name operator"><</span><span class="token generic-function generic class-name string">'viewCount'</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name operator">|</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name string">'hookIndex'</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name operator">|</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name string">'growthIndex'</span><span class="token generic-function generic class-name operator">></span><span class="token punctuation">(</span><span class="token string">'viewCount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">filteredVideos</span><span class="token punctuation">,</span><span class=""> setFilteredVideos</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token generic-function function">useState</span><span class="token generic-function generic class-name operator"><</span><span class="token generic-function generic class-name maybe-class-name">Video</span><span class="token generic-function generic class-name punctuation">[</span><span class="token generic-function generic class-name punctuation">]</span><span class="token generic-function generic class-name operator">></span><span class="token punctuation">(</span><span class="">videos</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì •ë ¬ ë° í•„í„° ì ìš©</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">let</span><span class=""> sorted </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">[</span><span class="token spread operator">...</span><span class="">videos</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">sortBy </span><span class="token operator">===</span><span class=""></span><span class="token string">'viewCount'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">      sorted</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">a</span><span class="token punctuation">,</span><span class=""> b</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""> b</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class=""></span><span class="token operator">-</span><span class=""> a</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">sortBy </span><span class="token operator">===</span><span class=""></span><span class="token string">'hookIndex'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> indexOrder </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token string-property property">'A'</span><span class="token operator">:</span><span class=""></span><span class="token number">0</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'B'</span><span class="token operator">:</span><span class=""></span><span class="token number">1</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'C'</span><span class="token operator">:</span><span class=""></span><span class="token number">2</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'D'</span><span class="token operator">:</span><span class=""></span><span class="token number">3</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'F'</span><span class="token operator">:</span><span class=""></span><span class="token number">4</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">      sorted</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">a</span><span class="token punctuation">,</span><span class=""> b</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""> indexOrder</span><span class="token punctuation">[</span><span class="">a</span><span class="token punctuation">.</span><span class="token property-access">hookIndex</span><span class=""></span><span class="token keyword module">as</span><span class=""></span><span class="token keyword">keyof</span><span class=""></span><span class="token keyword">typeof</span><span class=""> indexOrder</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">-</span><span class=""> indexOrder</span><span class="token punctuation">[</span><span class="">b</span><span class="token punctuation">.</span><span class="token property-access">hookIndex</span><span class=""></span><span class="token keyword module">as</span><span class=""></span><span class="token keyword">keyof</span><span class=""></span><span class="token keyword">typeof</span><span class=""> indexOrder</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">sortBy </span><span class="token operator">===</span><span class=""></span><span class="token string">'growthIndex'</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> indexOrder </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token string-property property">'A'</span><span class="token operator">:</span><span class=""></span><span class="token number">0</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'B'</span><span class="token operator">:</span><span class=""></span><span class="token number">1</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'C'</span><span class="token operator">:</span><span class=""></span><span class="token number">2</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'D'</span><span class="token operator">:</span><span class=""></span><span class="token number">3</span><span class="token punctuation">,</span><span class=""></span><span class="token string-property property">'F'</span><span class="token operator">:</span><span class=""></span><span class="token number">4</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">      sorted</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">a</span><span class="token punctuation">,</span><span class=""> b</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""> indexOrder</span><span class="token punctuation">[</span><span class="">a</span><span class="token punctuation">.</span><span class="token property-access">growthIndex</span><span class=""></span><span class="token keyword module">as</span><span class=""></span><span class="token keyword">keyof</span><span class=""></span><span class="token keyword">typeof</span><span class=""> indexOrder</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">-</span><span class=""> indexOrder</span><span class="token punctuation">[</span><span class="">b</span><span class="token punctuation">.</span><span class="token property-access">growthIndex</span><span class=""></span><span class="token keyword module">as</span><span class=""></span><span class="token keyword">keyof</span><span class=""></span><span class="token keyword">typeof</span><span class=""> indexOrder</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token function">setFilteredVideos</span><span class="token punctuation">(</span><span class="">sorted</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">[</span><span class="">videos</span><span class="token punctuation">,</span><span class=""> sortBy</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ë¹„ë””ì˜¤ ì„ íƒ ì²˜ë¦¬</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">handleVideoSelect</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">video</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">Video</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setSelectedVideo</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setIsSidebarOpen</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token comment">// ì‚¬ì´ë“œë°” ë‹«ê¸°</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">handleCloseSidebar</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function">setIsSidebarOpen</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">  
</span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">relative flex</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">flex-1 transition-all </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">isSidebarOpen </span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'mr-96'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'mr-0'</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* í•„í„° ë° ì •ë ¬ ì»¨íŠ¸ë¡¤ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mb-6 flex flex-wrap gap-4 items-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h2</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-2xl font-bold</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ê²€ìƒ‰ ê²°ê³¼</span><span class="token tag punctuation"></</span><span class="token tag">h2</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-gray-500 text-sm</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="">videos</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">}</span><span class="token plain-text">ê°œì˜ ì˜ìƒì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤</span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex gap-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">select</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">value</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">sortBy</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onChange</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">e</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setSortBy</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">e</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">target</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">value</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword module">as</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">'viewCount'</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript operator">|</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">'hookIndex'</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript operator">|</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">'growthIndex'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">border rounded p-2 text-sm</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">option</span><span class="token tag"></span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">viewCount</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ì¡°íšŒìˆ˜ ìˆœ</span><span class="token tag punctuation"></</span><span class="token tag">option</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">option</span><span class="token tag"></span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">hookIndex</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">í›„í‚¹ ì§€ìˆ˜ ìˆœ</span><span class="token tag punctuation"></</span><span class="token tag">option</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">option</span><span class="token tag"></span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">growthIndex</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ì„±ì¥ ì§€ìˆ˜ ìˆœ</span><span class="token tag punctuation"></</span><span class="token tag">option</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">select</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ê´€ë ¨ í‚¤ì›Œë“œ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">relatedKeywords</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""></span><span class="token operator">></span><span class=""></span><span class="token number">0</span><span class=""></span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mb-6</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h3</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-lg font-medium mb-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ê´€ë ¨ í‚¤ì›Œë“œ</span><span class="token tag punctuation"></</span><span class="token tag">h3</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex flex-wrap gap-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">relatedKeywords</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">keyword</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class="">              
</span><span class=""><span class="">                  key</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="">keyword</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class="">                  href</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/search?keyword=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation function">encodeURIComponent</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class="">                  className</span><span class="token operator">=</span><span class="token string">"bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-sm hover:bg-blue-100 transition-colors"</span><span class="">
</span></span><span class=""><span class=""></span><span class="token operator">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class="">keyword</span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"></</span><span class="token tag">a</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ë¹„ë””ì˜¤ ëª©ë¡ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">space-y-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">filteredVideos</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">VideoCard</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">key</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">videoId</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">video</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">handleVideoSelect</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">isSelected</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">selectedVideo</span><span class="token tag script language-javascript operator">?.</span><span class="token tag script language-javascript">videoId </span><span class="token tag script language-javascript operator">===</span><span class="token tag script language-javascript"> video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">videoId</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ë¶„ì„ ì‚¬ì´ë“œë°” */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">fixed right-0 top-0 h-full w-96 bg-white shadow-xl border-l overflow-y-auto transition-transform </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation">          isSidebarOpen </span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'translate-x-0'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'translate-x-full'</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">style</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript"> zIndex</span><span class="token tag script language-javascript operator">:</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript number">40</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">}</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">selectedVideo </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag class-name">AnalysisSidebar</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">video</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">selectedVideo</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onClose</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">handleCloseSidebar</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">roundNo</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">roundNo</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 3.5 ë¹„ë””ì˜¤ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ (ë¼ì¸í˜•)

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class=""><span class="token comment">// components/client/VideoCard.tsx</span><span class="">
</span></span><span class=""><span class=""></span><span class="token string">'use client'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"></span><span class="token imports maybe-class-name">Eye</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Users</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Clock</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">Award</span><span class="token imports punctuation">,</span><span class="token imports"></span><span class="token imports maybe-class-name">TrendingUp</span><span class="token imports"></span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'lucide-react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword">interface</span><span class=""></span><span class="token class-name maybe-class-name">VideoCardProps</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">  video</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class="">    videoId</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    title</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    thumbnail</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    channelTitle</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    viewCount</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    subscriberCount</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    duration</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    publishDate</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    hookIndex</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">    growthIndex</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token function-variable function">onClick</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token keyword">void</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class="">  isSelected</span><span class="token operator">:</span><span class=""></span><span class="token builtin">boolean</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ìˆ«ì í¬ë§· í•¨ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> formatNumber </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">num</span><span class="token operator">:</span><span class=""></span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">>=</span><span class=""></span><span class="token number">10000000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">/</span><span class=""></span><span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token string">'ì²œë§Œ'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">>=</span><span class=""></span><span class="token number">10000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">/</span><span class=""></span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token string">'ë§Œ'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">>=</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">/</span><span class=""></span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class=""></span><span class="token operator">+</span><span class=""></span><span class="token string">'ì²œ'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> num</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token comment">// ì¸ë±ìŠ¤ ìƒ‰ìƒ í•¨ìˆ˜</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> getIndexColor </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">index</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">switch</span><span class=""></span><span class="token punctuation">(</span><span class="">index</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'A'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'text-green-500 border-green-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'B'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'text-blue-500 border-blue-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'C'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'text-yellow-500 border-yellow-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'D'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'text-orange-500 border-orange-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword">case</span><span class=""></span><span class="token string">'F'</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'text-red-500 border-red-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword module">default</span><span class="token operator">:</span><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token string">'text-gray-500 border-gray-500'</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="">
</span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">VideoCard</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> video</span><span class="token punctuation">,</span><span class=""> onClick</span><span class="token punctuation">,</span><span class=""> isSelected </span><span class="token punctuation">}</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">VideoCardProps</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class=""><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">flex gap-4 p-4 border rounded-lg cursor-pointer hover:shadow-md transition-shadow </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation">        isSelected </span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'border-blue-500 bg-blue-50'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'border-gray-200'</span><span class="token tag script language-javascript template-string interpolation">
</span></span><span class=""><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">onClick</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ì¸ë„¤ì¼ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">relative w-64 h-36 flex-shrink-0</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">img</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">src</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">thumbnail</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">alt</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">title</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full h-full object-cover rounded</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class=""><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">absolute bottom-2 right-2 bg-black bg-opacity-70 text-white text-xs px-1.5 py-0.5 rounded</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">duration</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ì½˜í…ì¸  */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex-1 flex flex-col justify-between</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h3</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">font-medium text-lg mb-1 line-clamp-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">h3</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-gray-600 text-sm</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">channelTitle</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">      
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex flex-wrap items-center gap-x-4 gap-y-2 mt-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ì¡°íšŒìˆ˜ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center text-sm text-gray-600</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Eye</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">viewCount</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* êµ¬ë…ì ìˆ˜ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center text-sm text-gray-600</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Users</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">subscriberCount</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* í›„í‚¹ ì§€ìˆ˜ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Award</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1 text-gray-600</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">text-sm font-medium border rounded-full w-6 h-6 flex items-center justify-center </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation function">getIndexColor</span><span class="token tag script language-javascript template-string interpolation punctuation">(</span><span class="token tag script language-javascript template-string interpolation">video</span><span class="token tag script language-javascript template-string interpolation punctuation">.</span><span class="token tag script language-javascript template-string interpolation property-access">hookIndex</span><span class="token tag script language-javascript template-string interpolation punctuation">)</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">hookIndex</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">        
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ì„±ì¥ ì§€ìˆ˜ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">TrendingUp</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 mr-1 text-gray-600</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">span</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">text-sm font-medium border rounded-full w-6 h-6 flex items-center justify-center </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation function">getIndexColor</span><span class="token tag script language-javascript template-string interpolation punctuation">(</span><span class="token tag script language-javascript template-string interpolation">video</span><span class="token tag script language-javascript template-string interpolation punctuation">.</span><span class="token tag script language-javascript template-string interpolation property-access">growthIndex</span><span class="token tag script language-javascript template-string interpolation punctuation">)</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">growthIndex</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">span</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">    
</span><span class=""><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ìš°ì¸¡ ë²„íŠ¼ ì˜ì—­ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-blue-500 font-medium text-sm</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="">          ìƒì„¸ ë¶„ì„
</span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class=""><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

### 3.6 ë¶„ì„ ì‚¬ì´ë“œë°” ì»´í¬ë„ŒíŠ¸

<pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">tsx</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-tsx"><span class="token plain-text"><span class="token comment">// components/client/AnalysisSidebar.tsx</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token string">'use client'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text">
</span><span class="token plain-text"><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useState</span><span class="token imports punctuation">,</span><span class="token imports"> useEffect </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token punctuation">{</span><span class=""></span><span class="token constant">X</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">Play</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">PauseCircle</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">Code</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">FileText</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">BarChart2</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">MessageSquare</span><span class="token punctuation">,</span><span class=""></span><span class="token maybe-class-name">Copy</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'lucide-react'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> toast </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'react-hot-toast'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token keyword module">import</span><span class=""></span><span class="token imports punctuation">{</span><span class="token imports"> useAnalysis </span><span class="token imports punctuation">}</span><span class=""></span><span class="token keyword module">from</span><span class=""></span><span class="token string">'@/hooks/useAnalysis'</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text">
</span><span class="token plain-text"><span class=""></span><span class="token keyword">interface</span><span class=""></span><span class="token class-name maybe-class-name">AnalysisSidebarProps</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class="">  video</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class="">    videoId</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class="">    title</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class="">    thumbnail</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class="">    channelTitle</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token function-variable function">onClose</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token keyword">void</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class="">  roundNo</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="token plain-text">
</span><span class="token plain-text"><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function maybe-class-name">AnalysisSidebar</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> video</span><span class="token punctuation">,</span><span class=""> onClose</span><span class="token punctuation">,</span><span class=""> roundNo </span><span class="token punctuation">}</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">AnalysisSidebarProps</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">[</span><span class="">activeTab</span><span class="token punctuation">,</span><span class=""> setActiveTab</span><span class="token punctuation">]</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token generic-function function">useState</span><span class="token generic-function generic class-name operator"><</span><span class="token generic-function generic class-name string">'script'</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name operator">|</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name string">'analysis'</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name operator">|</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name string">'thumbnail'</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name operator">|</span><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name string">'redesign'</span><span class="token generic-function generic class-name operator">></span><span class="token punctuation">(</span><span class="token string">'analysis'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text">  
</span><span class="token plain-text"><span class=""></span><span class="token comment">// ë¶„ì„ ë°ì´í„° Hook ì‚¬ìš©</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> 
</span></span><span class="token plain-text"><span class="">    data</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class="token plain-text"><span class="">    isLoading</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class="token plain-text"><span class="">    error</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class="token plain-text"><span class="">    generateScript</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class="token plain-text"><span class="">    generateAnalysis</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class="token plain-text"><span class="">    generateThumbnail</span><span class="token punctuation">,</span><span class=""> 
</span></span><span class="token plain-text">    generateRedesign 
</span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token function">useAnalysis</span><span class="token punctuation">(</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">videoId</span><span class="token punctuation">,</span><span class=""> roundNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text">
</span><span class="token plain-text"><span class=""></span><span class="token comment">// íƒ­ ë³€ê²½ ì‹œ í•„ìš”í•œ ë°ì´í„° ìƒì„±</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">activeTab </span><span class="token operator">===</span><span class=""></span><span class="token string">'script'</span><span class=""></span><span class="token operator">&&</span><span class=""></span><span class="token operator">!</span><span class="">data</span><span class="token operator">?.</span><span class="">script</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token function">generateScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">activeTab </span><span class="token operator">===</span><span class=""></span><span class="token string">'analysis'</span><span class=""></span><span class="token operator">&&</span><span class=""></span><span class="token operator">!</span><span class="">data</span><span class="token operator">?.</span><span class="">analysis</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token function">generateAnalysis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">activeTab </span><span class="token operator">===</span><span class=""></span><span class="token string">'thumbnail'</span><span class=""></span><span class="token operator">&&</span><span class=""></span><span class="token operator">!</span><span class="">data</span><span class="token operator">?.</span><span class="">thumbnail</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token function">generateThumbnail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">else</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">activeTab </span><span class="token operator">===</span><span class=""></span><span class="token string">'redesign'</span><span class=""></span><span class="token operator">&&</span><span class=""></span><span class="token operator">!</span><span class="">data</span><span class="token operator">?.</span><span class="">redesign</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token function">generateRedesign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">[</span><span class="">activeTab</span><span class="token punctuation">,</span><span class=""> data</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text">
</span><span class="token plain-text"><span class=""></span><span class="token comment">// í´ë¦½ë³´ë“œ ë³µì‚¬ í•¨ìˆ˜</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token function-variable function">copyToClipboard</span><span class=""></span><span class="token operator">=</span><span class=""></span><span class="token punctuation">(</span><span class="">text</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">,</span><span class=""> label</span><span class="token operator">:</span><span class=""></span><span class="token builtin">string</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token dom variable">navigator</span><span class="token punctuation">.</span><span class="token property-access">clipboard</span><span class="token punctuation">.</span><span class="token method function property-access">writeText</span><span class="token punctuation">(</span><span class="">text</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class="">      toast</span><span class="token punctuation">.</span><span class="token method function property-access">success</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">label</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> ë³µì‚¬ ì™„ë£Œ!</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""></span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">{</span><span class="">
</span></span><span class="token plain-text"><span class="">      toast</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span></span><span class="token plain-text">
</span><span class="token plain-text"><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">h-full flex flex-col bg-white</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* í—¤ë” */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">p-4 border-b flex justify-between items-center</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h3</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">font-semibold</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">ì½˜í…ì¸  ë¶„ì„</span><span class="token tag punctuation"></</span><span class="token tag">h3</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">onClose</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-gray-500 hover:text-gray-700</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">X</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-5 h-5</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text">    
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ë¹„ë””ì˜¤ ë¯¸ë¦¬ë³´ê¸° */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">p-4 border-b</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">relative aspect-video mb-3</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">img</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">src</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">thumbnail</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">alt</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">video</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript property-access">title</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-full h-full object-cover rounded</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">a</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">href</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">https://www.youtube.com/watch?v=</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">video</span><span class="token tag script language-javascript template-string interpolation punctuation">.</span><span class="token tag script language-javascript template-string interpolation property-access">videoId</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">target</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">_blank</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">noopener noreferrer</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">absolute inset-0 flex items-center justify-center bg-black bg-opacity-30 group</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">bg-red-600 text-white rounded-full p-2 group-hover:scale-110 transition-transform</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Play</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-6 h-6</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">a</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">h4</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">font-medium line-clamp-2</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">h4</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-sm text-gray-600 mt-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token punctuation">{</span><span class="">video</span><span class="token punctuation">.</span><span class="token property-access">channelTitle</span><span class="token punctuation">}</span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text">    
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* íƒ­ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex border-b</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">flex-1 py-2 text-sm font-medium </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">activeTab </span><span class="token tag script language-javascript template-string interpolation operator">===</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'analysis'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-blue-600 border-b-2 border-blue-600'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-gray-600'</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setActiveTab</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript string">'analysis'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">BarChart2</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 inline-block mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="token plain-text">          ì½˜í…ì¸  ë¶„ì„
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">flex-1 py-2 text-sm font-medium </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">activeTab </span><span class="token tag script language-javascript template-string interpolation operator">===</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'script'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-blue-600 border-b-2 border-blue-600'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-gray-600'</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setActiveTab</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript string">'script'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">FileText</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 inline-block mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="token plain-text">          ìŠ¤í¬ë¦½íŠ¸
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">flex-1 py-2 text-sm font-medium </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">activeTab </span><span class="token tag script language-javascript template-string interpolation operator">===</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'redesign'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-blue-600 border-b-2 border-blue-600'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-gray-600'</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setActiveTab</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript string">'redesign'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">Code</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 inline-block mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="token plain-text">          ì—­ì„¤ê³„
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string">flex-1 py-2 text-sm font-medium </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">activeTab </span><span class="token tag script language-javascript template-string interpolation operator">===</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'thumbnail'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-blue-600 border-b-2 border-blue-600'</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"></span><span class="token tag script language-javascript template-string interpolation string">'text-gray-600'</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">setActiveTab</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript string">'thumbnail'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag class-name">MessageSquare</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">w-4 h-4 inline-block mr-1</span><span class="token tag attr-value punctuation">"</span><span class="token tag"></span><span class="token tag punctuation">/></span><span class="token plain-text">
</span></span><span class="token plain-text">          ì¸ë„¤ì¼
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text">    
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ì½˜í…ì¸  ì˜ì—­ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex-1 overflow-y-auto p-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">isLoading </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">flex items-center justify-center h-full</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="token plain-text">      
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">error </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">text-center text-red-500 py-8</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤</span><span class="token tag punctuation"></</span><span class="token tag">p</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"><</span><span class="token tag">button</span><span class="token tag"> 
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm</span><span class="token tag attr-value punctuation">"</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript arrow operator">=></span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">
</span></span><span class="token plain-text"><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword control-flow">if</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">activeTab </span><span class="token tag script language-javascript operator">===</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">'script'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">generateScript</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">;</span><span class="token tag script language-javascript">
</span></span><span class="token plain-text"><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword control-flow">else</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword control-flow">if</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">activeTab </span><span class="token tag script language-javascript operator">===</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">'analysis'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">generateAnalysis</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">;</span><span class="token tag script language-javascript">
</span></span><span class="token plain-text"><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword control-flow">else</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword control-flow">if</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">activeTab </span><span class="token tag script language-javascript operator">===</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">'thumbnail'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">generateThumbnail</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">;</span><span class="token tag script language-javascript">
</span></span><span class="token plain-text"><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword control-flow">else</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript keyword control-flow">if</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">activeTab </span><span class="token tag script language-javascript operator">===</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript string">'redesign'</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"></span><span class="token tag script language-javascript function">generateRedesign</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">;</span><span class="token tag script language-javascript">
</span></span><span class="token plain-text"><span class="token tag script language-javascript"></span><span class="token tag script language-javascript punctuation">}</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag">
</span></span><span class="token plain-text"><span class="token tag"></span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text">              ë‹¤ì‹œ ì‹œë„
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">button</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token tag punctuation"></</span><span class="token tag">div</span><span class="token tag punctuation">></span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="token plain-text">      
</span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token operator">!</span><span class="">isLoading </span><span class="token operator">&&</span><span class=""></span><span class="token operator">!</span><span class="">error </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token tag punctuation"><</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="token comment">/* ë¶„ì„ íƒ­ */</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="token plain-text"><span class="token plain-text"></span><span class="token punctuation">{</span><span class="">activeTab </span><span class="token operator">===</span><span class=""></span><span class="token string">'analysis'</span><span class=""></span><span class="token operator">&&</span><span class=""> data</span><span class="token operator">?.</span><span class="">analysis </span><span class="token operator">&&</span><span class=""></span><span class="token punctuation">(</span><span class="">
</span></span><span class="token plain-text"><span class=""></span><span class="token tag punctuation"><</span><span class="token tag">div</span><span class="token tag"></span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">"</span><span class="token tag attr-value">space-y-4</span><span class="token tag attr-value punctuation">"</span><span class="token tag punctuation">></span><span class="token plain-text">
</span></span><span class="token plain-text">                <div className="border rounded-lg p-4</span></code></div></div></div></pre>

Retry

Claude hit the max length for a message and has paused its response. You can write Continue to keep the chat going.

S

ë„ˆê°€ì§œì¤€ì½”ë“œë¥¼ë³´ë©´ êµ³ì´ triggerë¥¼ì‚¬ìš©í•´ì•¼í• ì´ìœ ê°€ì—†ëŠ”ê±°ê°™ì•„. ë§ì•„??

Edit

ë¶„ì„í•œ ì½”ë“œë¥¼ ì‚´í´ë³´ë©´, MongoDB Atlasì˜ íŠ¸ë¦¬ê±°ë¥¼ ë°˜ë“œì‹œ ì‚¬ìš©í•´ì•¼ í•  ì´ìœ ê°€ ì—†ì–´ ë³´ì…ë‹ˆë‹¤. ì™œ ê·¸ëŸ°ì§€ ì„¤ëª…í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

íŠ¸ë¦¬ê±°ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ë³€í™”ê°€ ë°œìƒí•  ë•Œ ìë™ìœ¼ë¡œ íŠ¹ì • ì‘ì—…ì„ ì‹¤í–‰í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·€í•˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¡°ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ íŠ¸ë¦¬ê±°ê°€ í•„ìˆ˜ì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤:

1. **ì§ì ‘ì ì¸ API í˜¸ì¶œ ê°€ëŠ¥ì„±** : ì½”ë“œì—ì„œ ë³´ë©´, ì‚¬ìš©ìê°€ í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰í•˜ë©´ ì„œë²„ ì¸¡ API ë¼ìš°íŠ¸ì—ì„œ ì²˜ë¦¬ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ì‹œì ì—ì„œ YouTube API ìš”ì²­ì´ë‚˜ ìŠ¤í¬ë˜í•‘ ì‘ì—…ì„ ì§ì ‘ í˜¸ì¶œí•˜ê±°ë‚˜ íì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2. **ë¹„ë™ê¸° ì²˜ë¦¬ ëŒ€ì•ˆ** : NextJSì™€ Vercel í™˜ê²½ì—ì„œëŠ” Edge Functions, Serverless Functions, ë˜ëŠ” ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…(Background Jobs)ì„ í™œìš©í•˜ì—¬ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
3. **ë³µì¡ì„± ì¦ê°€** : Atlas íŠ¸ë¦¬ê±°ë¥¼ ì¶”ê°€í•˜ë©´ ë””ë²„ê¹…ì´ ë” ì–´ë ¤ì›Œì§€ê³ , ì‹œìŠ¤í…œ êµ¬ì¡°ê°€ ë³µì¡í•´ì§‘ë‹ˆë‹¤. íŠ¹íˆ ë¡œì»¬ ê°œë°œ í™˜ê²½ê³¼ í”„ë¡œë•ì…˜ í™˜ê²½ì˜ ì°¨ì´ê°€ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
4. **ë°ì´í„° íë¦„ ê´€ë¦¬** : ì œê³µí•˜ì‹  ì½”ë“œë¥¼ ë³´ë©´ ì´ë¯¸ ìƒíƒœ ê´€ë¦¬(status: "0", "1", "2" ë“±)ë¥¼ API ë¼ìš°íŠ¸ì—ì„œ ì§ì ‘ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ íŒ¨í„´ì„ í™•ì¥í•˜ì—¬ ìŠ¤í¬ë˜í•‘ ì‘ì—…ë„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ëŒ€ì‹  ë‹¤ìŒê³¼ ê°™ì€ ì ‘ê·¼ ë°©ì‹ì´ ë” ì í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **API ë¼ìš°íŠ¸ í™•ì¥** : í‚¤ì›Œë“œ ê²€ìƒ‰ APIì—ì„œ ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤ë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ê³ , ê²°ê³¼ë¥¼ ë°›ì•„ ì €ì¥í•˜ëŠ” êµ¬ì¡°.
2. **í ì‹œìŠ¤í…œ í™œìš©** : AWS SQS, RabbitMQ ë˜ëŠ” ê°„ë‹¨í•œ ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë°˜ íë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë˜í•‘ ì‘ì—…ì„ ê´€ë¦¬.
3. **Vercel Cron Jobs ë˜ëŠ” Scheduled Functions** : ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ë¡œ ì²˜ë¦¬ ëŒ€ê¸° ì¤‘ì¸ í‚¤ì›Œë“œë¥¼ ê°€ì ¸ì™€ ì²˜ë¦¬.

ê·€í•˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì´ë¯¸ ìƒíƒœ ì½”ë“œë¥¼ í†µí•´ ë¹„ë™ê¸° ì²˜ë¦¬ íŒ¨í„´ì„ êµ¬í˜„í•˜ê³  ìˆìœ¼ë¯€ë¡œ, íŠ¸ë¦¬ê±° ì—†ì´ë„ íš¨ê³¼ì ìœ¼ë¡œ ë™ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¸ë¦¬ê±°ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ì— ì¦‰ê°ì ìœ¼ë¡œ ë°˜ì‘í•´ì•¼ í•˜ëŠ” ê²½ìš°ë‚˜, ì™¸ë¶€ ì‹œìŠ¤í…œì—ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì •í•  ë•Œ ìœ ìš©í•˜ì§€ë§Œ, í˜„ì¬ êµ¬ì¡°ì—ì„œëŠ” í•„ìˆ˜ì ì´ì§€ ì•Šì•„ ë³´ì…ë‹ˆë‹¤.

**2 / 2**

Retry

S

ê·¸ëŸ¼, nextjs ì½”ë“œë§Œìœ¼ë¡œë„ ë¸”ë½ ì—†ì´ ìŠ¤í¬ë˜í•‘ì´ ê°€ëŠ¥í• ê¹Œ?
ì‹¤ì œë¡œ ë‚´ ë¡œì»¬ì„œë²„ë¥¼ 24ì‹œê°„ ì¼œë†“ì§€ ì•Šì„ê±°ê³ 

ì •ë§ api ts íŒŒì¼ ì•ˆì— ì½”ë“œë§Œìœ¼ë¡œ vercelì— í˜¸ìŠ¤íŒ…ì„ í•˜ë©´ ë ê¹Œ?

Edit

ë„¤, NextJS ì½”ë“œë§Œìœ¼ë¡œë„ Vercel í˜¸ìŠ¤íŒ… í™˜ê²½ì—ì„œ ìŠ¤í¬ë˜í•‘ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ì¤‘ìš”í•œ ì œì•½ ì‚¬í•­ë“¤ê³¼ ê³ ë ¤í•´ì•¼ í•  ì ë“¤ì´ ìˆìŠµë‹ˆë‹¤.

## Vercel í™˜ê²½ì—ì„œì˜ ìŠ¤í¬ë˜í•‘ êµ¬í˜„ ë°©ë²•

1. **Serverless Function ì‹œê°„ ì œí•œ**

   * Vercelì˜ Serverless Function(API ë¼ìš°íŠ¸)ì€ ê¸°ë³¸ì ìœ¼ë¡œ 10ì´ˆ ì‹œê°„ ì œí•œì´ ìˆìŠµë‹ˆë‹¤(Pro í”Œëœì—ì„œëŠ” 60ì´ˆ).
   * ìŠ¤í¬ë˜í•‘ì€ ì¢…ì¢… 10ì´ˆ ì´ìƒ ê±¸ë¦´ ìˆ˜ ìˆì–´ ì œí•œì‹œê°„ ë‚´ì— ì™„ë£Œí•˜ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2. **ë¹„ë™ê¸° ì²˜ë¦¬ íŒ¨í„´ êµ¬í˜„**

   * ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì¼ë°˜ì ì¸ íŒ¨í„´ì€ "ìš”ì²­-ì‘ë‹µ ë¶„ë¦¬"ì…ë‹ˆë‹¤:
     1. ì‚¬ìš©ì ìš”ì²­ ì‹œ ì¦‰ì‹œ ì‘ì—… ID ë°˜í™˜ (status: "0" ìƒíƒœë¡œ ì €ì¥)
     2. ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë³„ë„ì˜ ë©”ì»¤ë‹ˆì¦˜ ì‚¬ìš©
     3. í´ë¼ì´ì–¸íŠ¸ê°€ ì£¼ê¸°ì ìœ¼ë¡œ ìƒíƒœ í™•ì¸(í´ë§)
3. **êµ¬í˜„ ê°€ëŠ¥í•œ ë°©ë²•ë“¤** **A. Edge Function + ì™¸ë¶€ ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤**

   <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// pages/api/scrape.ts</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">handler</span><span class="token punctuation">(</span><span class="">req</span><span class="token punctuation">,</span><span class=""> res</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> keyword </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// íˆìŠ¤í† ë¦¬ ë ˆì½”ë“œ ìƒì„± (status: "0")</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> history </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class="">    keyword</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">    status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// ê¸°íƒ€ í•„ë“œ...</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// ì™¸ë¶€ ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤ API í˜¸ì¶œ (ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://your-scraping-service.com/api'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class="">    method</span><span class="token operator">:</span><span class=""></span><span class="token string">'POST'</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">    body</span><span class="token operator">:</span><span class=""></span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
   </span></span><span class=""><span class="">      keyword</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">      callbackUrl</span><span class="token operator">:</span><span class=""></span><span class="token string">'https://your-vercel-app.com/api/webhook/scrape-complete'</span><span class=""> 
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="">err </span><span class="token arrow operator">=></span><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'ìŠ¤í¬ë˜í•‘ ìš”ì²­ ì‹¤íŒ¨:'</span><span class="token punctuation">,</span><span class=""> err</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// ì¦‰ì‹œ ì‘ë‹µ</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> 
   </span></span><span class=""><span class="">    status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class="token punctuation">,</span><span class=""> 
   </span></span><span class=""><span class="">    data</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> history</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> _id</span><span class="token operator">:</span><span class=""> history</span><span class="token punctuation">.</span><span class="token property-access">insertedId</span><span class="token punctuation">,</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token punctuation">}</span><span class=""> 
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class="">
   </span><span class=""><span class=""></span><span class="token comment">// pages/api/webhook/scrape-complete.ts</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword module">default</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">handler</span><span class="token punctuation">(</span><span class="">req</span><span class="token punctuation">,</span><span class=""> res</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""></span><span class="token punctuation">{</span><span class=""> historyId</span><span class="token punctuation">,</span><span class=""> results </span><span class="token punctuation">}</span><span class=""></span><span class="token operator">=</span><span class=""> req</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> _id</span><span class="token operator">:</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name maybe-class-name">ObjectId</span><span class="token punctuation">(</span><span class="">historyId</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> $set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'videos'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">insertMany</span><span class="token punctuation">(</span><span class="">results</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">'success'</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

   **B. Vercel Cron Jobs**

   <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// app/api/cron/process-scraping-queue/route.ts</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">const</span><span class=""> config </span><span class="token operator">=</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class="">  runtime</span><span class="token operator">:</span><span class=""></span><span class="token string">'edge'</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">
   </span><span class=""><span class=""></span><span class="token keyword module">export</span><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token constant">GET</span><span class="token punctuation">(</span><span class="">request</span><span class="token operator">:</span><span class=""></span><span class="token maybe-class-name">Request</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> authHeader </span><span class="token operator">=</span><span class=""> request</span><span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'authorization'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">if</span><span class=""></span><span class="token punctuation">(</span><span class="">authHeader </span><span class="token operator">!==</span><span class=""></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">Bearer </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">process</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">env</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation constant">CRON_SECRET</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name maybe-class-name">Response</span><span class="token punctuation">(</span><span class="token string">'Unauthorized'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">401</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// ì²˜ë¦¬ ëŒ€ê¸° ì¤‘ì¸ ì‘ì—… ì¡°íšŒ</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> pendingJobs </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">"0"</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">.</span><span class="token method function property-access">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// ê° ì‘ì—… ì²˜ë¦¬</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">for</span><span class=""></span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> job </span><span class="token keyword">of</span><span class=""> pendingJobs</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">try</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> results </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">scrapeYouTube</span><span class="token punctuation">(</span><span class="">job</span><span class="token punctuation">.</span><span class="token property-access">keyword</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">    
   </span><span class=""><span class=""></span><span class="token comment">// ê²°ê³¼ ì €ì¥</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'videos'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">insertMany</span><span class="token punctuation">(</span><span class="">results</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">    
   </span><span class=""><span class=""></span><span class="token comment">// ìƒíƒœ ì—…ë°ì´íŠ¸</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> _id</span><span class="token operator">:</span><span class=""> job</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> $set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">"1"</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token keyword control-flow">catch</span><span class=""></span><span class="token punctuation">(</span><span class="">error</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨: </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">job</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">keyword</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""> error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">await</span><span class=""> db</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'keywordHistory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> _id</span><span class="token operator">:</span><span class=""> job</span><span class="token punctuation">.</span><span class="token property-access">_id</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">{</span><span class=""> $set</span><span class="token operator">:</span><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token string">"2"</span><span class="token punctuation">,</span><span class=""> error</span><span class="token operator">:</span><span class=""> error</span><span class="token punctuation">.</span><span class="token property-access">message</span><span class=""></span><span class="token punctuation">}</span><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""></span><span class="token keyword">new</span><span class=""></span><span class="token class-name maybe-class-name">Response</span><span class="token punctuation">(</span><span class="token string">'Queue processed'</span><span class="token punctuation">,</span><span class=""></span><span class="token punctuation">{</span><span class=""> status</span><span class="token operator">:</span><span class=""></span><span class="token number">200</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>

   **C. ê²½ëŸ‰ ìŠ¤í¬ë˜í•‘ (ì œí•œëœ ë°ì´í„°ë§Œ ê°€ì ¸ì˜¤ê¸°)**

   <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs">typescript</div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0"><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 text-text-300 hover:bg-bg-200 opacity-60 hover:opacity-100" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="prismjs code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed"><code class="language-typescript"><span class=""><span class="token comment">// ì œí•œëœ ë°ì´í„°ë§Œ ê°€ì ¸ì˜¤ëŠ” ê²½ëŸ‰ ìŠ¤í¬ë˜í•‘ í•¨ìˆ˜</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">async</span><span class=""></span><span class="token keyword">function</span><span class=""></span><span class="token function">lightScrape</span><span class="token punctuation">(</span><span class="">keyword</span><span class="token punctuation">)</span><span class=""></span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token comment">// YouTube APIë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> searchResponse </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">https://www.googleapis.com/youtube/v3/search?part=snippet&q=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">keyword</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&key=</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">process</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation property-access">env</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation constant">YOUTUBE_API_KEY</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&maxResults=10&type=video</span><span class="token template-string template-punctuation string">`</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token keyword">const</span><span class=""> searchData </span><span class="token operator">=</span><span class=""></span><span class="token keyword control-flow">await</span><span class=""> searchResponse</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class="">  
   </span><span class=""><span class=""></span><span class="token comment">// ê¸°ë³¸ ë°ì´í„° ë³€í™˜ ë° ë°˜í™˜</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token keyword control-flow">return</span><span class=""> searchData</span><span class="token punctuation">.</span><span class="token property-access">items</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="">item </span><span class="token arrow operator">=></span><span class=""></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
   </span></span><span class=""><span class="">    videoId</span><span class="token operator">:</span><span class=""> item</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">.</span><span class="token property-access">videoId</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">    title</span><span class="token operator">:</span><span class=""> item</span><span class="token punctuation">.</span><span class="token property-access">snippet</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">    thumbnail</span><span class="token operator">:</span><span class=""> item</span><span class="token punctuation">.</span><span class="token property-access">snippet</span><span class="token punctuation">.</span><span class="token property-access">thumbnails</span><span class="token punctuation">.</span><span class="token property-access">high</span><span class="token punctuation">.</span><span class="token property-access">url</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">    channelTitle</span><span class="token operator">:</span><span class=""> item</span><span class="token punctuation">.</span><span class="token property-access">snippet</span><span class="token punctuation">.</span><span class="token property-access">channelTitle</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">    channelId</span><span class="token operator">:</span><span class=""> item</span><span class="token punctuation">.</span><span class="token property-access">snippet</span><span class="token punctuation">.</span><span class="token property-access">channelId</span><span class="token punctuation">,</span><span class="">
   </span></span><span class=""><span class="">    publishDate</span><span class="token operator">:</span><span class=""> item</span><span class="token punctuation">.</span><span class="token property-access">snippet</span><span class="token punctuation">.</span><span class="token property-access">publishedAt</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
   </span></span><span class=""><span class=""></span><span class="token punctuation">}</span></span></code></div></div></div></pre>
4. **ì™¸ë¶€ ì„œë¹„ìŠ¤ ì‚¬ìš© ì˜µì…˜**

   * **Bright Data / Zyte** - í´ë¼ìš°ë“œ ê¸°ë°˜ ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤
   * **Apify / ScrapingBee** - API ê¸°ë°˜ ì›¹ ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤
   * **Amazon Lambda** - ë” ê¸´ ì‹¤í–‰ ì‹œê°„ ì œí•œ(15ë¶„)ì´ ìˆëŠ” ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜
   * **ì‘ì€ ì „ìš© ì„œë²„** - Digital Ocean Dropletì´ë‚˜ Hetzner ê°™ì€ ì €ë ´í•œ VPS

## ê²°ë¡ 

24ì‹œê°„ ì„œë²„ë¥¼ ìš´ì˜í•˜ì§€ ì•Šê³ ë„ Vercel í™˜ê²½ì—ì„œ ìŠ¤í¬ë˜í•‘ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Vercelì˜ ì œí•œ ì‚¬í•­ì„ ê³ ë ¤í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì ‘ê·¼ ë°©ì‹ì´ ê°€ì¥ í˜„ì‹¤ì ì…ë‹ˆë‹¤:

1. **ê²½ëŸ‰ ìŠ¤í¬ë˜í•‘ + ì„¸ë¶€ ë¶„ì„ ë¶„ë¦¬**
   * ì´ˆê¸° ê²€ìƒ‰ ê²°ê³¼ëŠ” YouTube APIë¡œ ë¹ ë¥´ê²Œ ê°€ì ¸ì˜¤ê¸°
   * ì„¸ë¶€ ë¶„ì„ì´ë‚˜ ìƒì„¸ ìŠ¤í¬ë˜í•‘ì€ ë³„ë„ ìš”ì²­ìœ¼ë¡œ ì²˜ë¦¬
2. **ì™¸ë¶€ ìŠ¤í¬ë˜í•‘ ì„œë¹„ìŠ¤ í™œìš©**
   * ë³µì¡í•œ ìŠ¤í¬ë˜í•‘ì€ ì „ë¬¸ ì„œë¹„ìŠ¤ì— ìœ„ì„
   * Vercelì—ì„œëŠ” ê²°ê³¼ ì²˜ë¦¬ ë° í‘œì‹œë§Œ ë‹´ë‹¹
3. **ì •ê¸°ì ì¸ í¬ë¡  ì‘ì—…**
   * Vercel Cron Jobsë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ê¸°ì ìœ¼ë¡œ ëŒ€ê¸° ì¤‘ì¸ ì‘ì—… ì²˜ë¦¬
   * í•„ìš”í•œ ê²½ìš° ë§¤ 10ë¶„ë§ˆë‹¤ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ì •

ì´ ë°©ì‹ìœ¼ë¡œ 24ì‹œê°„ ì„œë²„ë¥¼ ìœ ì§€í•˜ì§€ ì•Šê³ ë„ ìŠ¤í¬ë˜í•‘ê³¼ ë°ì´í„° ë¶„ì„ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
